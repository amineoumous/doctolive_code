{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"C:\\\\app\\\\doctolive_code\\\\patient-doctolive\\\\pages\\\\consultation\\\\[id].js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React, { useEffect, useState } from 'react'; // import Config from 'Config'\n\nimport Config from './../../EndPoint';\nimport Card from './../../components/Card/Card';\nimport CardBody from './../../components/Card/CardBody';\nimport { Col, Row, Alert, Collapse } from 'react-bootstrap';\nimport DocumentC from './../../components/Documents/DocumentsC';\nimport Messages from './../../components/Chat/messages';\nimport InfoBar from './../../components/Chat/infoBar';\nimport VideoCall from './../../components/Chat/videoChat';\nimport SendMessageForm from './../../components/Chat/sendingMessage';\nimport CountDown from './../../components/Chat/CountDown/CountDown';\nimport Button from './../../components/CustomButtons/Button';\nimport Checkbox from './../../components/Checkbox/Checkbox';\nimport TextField from '@material-ui/core/TextField';\nimport { useRouter } from 'next/router';\nimport { useAuth } from './../../context/AuthContext';\nimport contentFR from './../../contentFR';\nimport contentEN from './../../contentEN';\nimport contentAR from './../../contentAR'; // export async function getServerSideProps(context) {\n//     const res = await fetch(`${Config.BACKEND_URL}/consultation/${context.params.id}`)\n//     const data = await res.json();\n//     console.log(data)\n//     if(!data){\n//         return {\n//             props: {teleconsultation: {}},\n//           }\n//     }\n//     return {\n//       props: {teleconsultation: data.consultation},\n//     }\n// }\n\nexport async function getServerSideProps(context) {\n  const {\n    req\n  } = context;\n  const cookies = getAppCookies(req);\n\n  if (!cookies.token) {\n    return {\n      props: {\n        isAuth: false\n      }\n    };\n  } else {\n    const res = await fetch(`${Config.BACKEND_URL}/consultation/${context.params.id}`, {\n      headers: {\n        'Accept': 'application/json',\n        'Content-Type': 'application/json',\n        'Authorization': `token ${cookies.token}`\n      }\n    });\n    const data = await res.json();\n    return {\n      props: {\n        isAuth: true,\n        teleconsultation: data.consultation\n      }\n    };\n  }\n}\n\nfunction getAppCookies(req) {\n  const parsedItems = {};\n\n  if (req.headers.cookie) {\n    const cookiesItems = req.headers.cookie.split('; ');\n    cookiesItems.forEach(cookies => {\n      const parsedItem = cookies.split('=');\n      parsedItems[parsedItem[0]] = decodeURI(parsedItem[1]);\n    });\n  }\n\n  return parsedItems;\n}\n\nexport default function ConsultationContainer({\n  teleconsultation,\n  socket\n}) {\n  const {\n    0: addRapport,\n    1: setAddRapport\n  } = useState(false);\n  const {\n    0: fieldValidationErrors,\n    1: setFieldValidationErrors\n  } = useState({});\n  const {\n    0: state,\n    1: setState\n  } = useState({\n    isCompleted: false\n  });\n  const {\n    0: response,\n    1: setResponse\n  } = useState({\n    sending: false,\n    success: false,\n    donneIncorecte: false\n  });\n  const router = useRouter();\n  const {\n    locale\n  } = router;\n  const content = locale === \"ar\" ? contentAR : locale === \"en\" ? contentEN : contentFR;\n  const {\n    userData\n  } = useAuth();\n\n  const handleSubmit = e => {\n    e.preventDefault();\n    setResponse(old => {\n      return _objectSpread(_objectSpread({}, old), {}, {\n        sending: true\n      });\n    });\n    let data = state;\n    fetch(`${Config.BACKEND_URL}/feedback`, {\n      method: \"post\",\n      headers: {\n        'Content-Type': 'application/json',\n        'Authorization': `token ${userData.token}`\n      },\n      body: JSON.stringify(_objectSpread(_objectSpread({}, data), {}, {\n        consultationId: teleconsultation.id\n      }))\n    }).then(r => r.json().then(res => {\n      if (!res.error) {\n        // props.setUserData(res);\n        setResponse({\n          sending: false,\n          success: true,\n          donneIncorecte: false\n        });\n      } else {\n        setResponse({\n          sending: false,\n          success: false,\n          donneIncorecte: true\n        });\n\n        if (res.validator) {} else {}\n      }\n    })).catch(error => {\n      console.log(error);\n      setResponse({\n        sending: false,\n        success: false,\n        donneIncorecte: true\n      });\n    });\n  };\n\n  const validateField = () => {};\n\n  const handleChange = ({\n    target: {\n      value,\n      name\n    }\n  }) => {\n    if (name === \"isCompleted\") {\n      setState(old => {\n        return _objectSpread(_objectSpread({}, old), {}, {\n          isCompleted: !state.isCompleted\n        });\n      });\n    } else {\n      setState(old => {\n        return _objectSpread(_objectSpread({}, old), {}, {\n          [name]: value\n        });\n      });\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"teleconsultation\",\n    children: /*#__PURE__*/_jsxDEV(Row, {\n      className: \"m-0\",\n      children: [/*#__PURE__*/_jsxDEV(Col, {\n        lg: \"6\",\n        md: 12,\n        sm: 12,\n        xs: 12,\n        children: /*#__PURE__*/_jsxDEV(ChatContainer, {\n          teleconsultation: teleconsultation,\n          socket: socket\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 166,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 165,\n        columnNumber: 16\n      }, this), /*#__PURE__*/_jsxDEV(Col, {\n        lg: \"6\",\n        md: 12,\n        sm: 12,\n        xs: 12,\n        children: [/*#__PURE__*/_jsxDEV(Card, {\n          children: /*#__PURE__*/_jsxDEV(CardBody, {\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \" Document \\xE0 partager dans cette consultation \"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 173,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(DocumentC, {\n                documents: teleconsultation ? teleconsultation.documents : [],\n                socket: socket,\n                consultation: teleconsultation\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 174,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 172,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 170,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 169,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Card, {\n          children: /*#__PURE__*/_jsxDEV(CardBody, {\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \" Ajouter un rapport  \"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 183,\n                columnNumber: 29\n              }, this), addRapport ? /*#__PURE__*/_jsxDEV(\"div\", {\n                children: /*#__PURE__*/_jsxDEV(\"form\", {\n                  onSubmit: handleSubmit,\n                  autoComplete: \"off\",\n                  children: [/*#__PURE__*/_jsxDEV(Row, {\n                    children: [/*#__PURE__*/_jsxDEV(Col, {\n                      xs: \"12\",\n                      md: \"6\",\n                      className: \"mt-3\",\n                      children: /*#__PURE__*/_jsxDEV(TextField, {\n                        error: fieldValidationErrors.nomError,\n                        placeholder: \"\",\n                        label: content.report.labelNom,\n                        required: false,\n                        variant: \"outlined\",\n                        name: \"type\",\n                        onBlur: validateField,\n                        value: state.nom,\n                        onChange: handleChange\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 191,\n                        columnNumber: 53\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 190,\n                      columnNumber: 49\n                    }, this), /*#__PURE__*/_jsxDEV(Col, {\n                      xs: \"12\",\n                      md: \"12\",\n                      className: \"mt-3\",\n                      children: /*#__PURE__*/_jsxDEV(TextField, {\n                        placeholder: \"\",\n                        variant: \"outlined\",\n                        required: false,\n                        error: fieldValidationErrors.prenomError,\n                        label: content.report.labelPrenom,\n                        onBlur: validateField,\n                        name: \"description\",\n                        fullWidth: true,\n                        value: state.description,\n                        onChange: handleChange\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 204,\n                        columnNumber: 53\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 203,\n                      columnNumber: 49\n                    }, this), /*#__PURE__*/_jsxDEV(Col, {\n                      xs: \"12\",\n                      md: \"6\",\n                      className: \"mt-3\",\n                      children: /*#__PURE__*/_jsxDEV(Checkbox, {\n                        placeholder: \"\",\n                        variant: \"outlined\",\n                        required: false,\n                        error: fieldValidationErrors.prenomError,\n                        label: content.report.labelEnd,\n                        name: \"isCompleted\",\n                        checked: state.isCompleted,\n                        rtl: locale === \"ar\" ? true : false,\n                        onChange: handleChange\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 219,\n                        columnNumber: 53\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 218,\n                      columnNumber: 49\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 189,\n                    columnNumber: 41\n                  }, this), /*#__PURE__*/_jsxDEV(Row, {\n                    className: \"justify-content-center\",\n                    children: /*#__PURE__*/_jsxDEV(Collapse, {\n                      in: response.donneIncorecte,\n                      children: /*#__PURE__*/_jsxDEV(\"div\", {\n                        className: \"mt-5\",\n                        children: /*#__PURE__*/_jsxDEV(Alert, {\n                          variant: \"danger\",\n                          children: content.report.errorSignup\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 235,\n                          columnNumber: 53\n                        }, this)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 234,\n                        columnNumber: 49\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 233,\n                      columnNumber: 45\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 232,\n                    columnNumber: 41\n                  }, this), /*#__PURE__*/_jsxDEV(Row, {\n                    className: \"justify-content-center\",\n                    children: /*#__PURE__*/_jsxDEV(Collapse, {\n                      in: response.success,\n                      children: /*#__PURE__*/_jsxDEV(\"div\", {\n                        className: \"mt-5\",\n                        children: /*#__PURE__*/_jsxDEV(Alert, {\n                          variant: \"success\",\n                          children: content.report.successSignup\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 244,\n                          columnNumber: 53\n                        }, this)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 243,\n                        columnNumber: 49\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 242,\n                      columnNumber: 45\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 241,\n                    columnNumber: 41\n                  }, this), /*#__PURE__*/_jsxDEV(Row, {\n                    className: \"align-items-center justify-content-around mt-4 \",\n                    children: /*#__PURE__*/_jsxDEV(Button, {\n                      type: \"submit\",\n                      color: \"primary\",\n                      children: [\" \", content.report.signup, \" \"]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 251,\n                      columnNumber: 45\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 250,\n                    columnNumber: 41\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 187,\n                  columnNumber: 37\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 186,\n                columnNumber: 33\n              }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n                children: /*#__PURE__*/_jsxDEV(Button, {\n                  color: \"primary\",\n                  onClick: () => setAddRapport(true),\n                  children: \" Ajouter rapport \"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 257,\n                  columnNumber: 37\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 256,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 182,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 180,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 179,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 168,\n        columnNumber: 16\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 164,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 163,\n    columnNumber: 9\n  }, this);\n}\n\nfunction ChatContainer(props) {\n  const {\n    0: onConsuting,\n    1: setonConsuting\n  } = useState(false);\n  const {\n    0: onCalling,\n    1: setonCalling\n  } = useState(false);\n  const {\n    0: difference,\n    1: setdifference\n  } = useState(0);\n  const {\n    0: now,\n    1: setnow\n  } = useState(0);\n  useEffect(() => {\n    if (props.socket) {\n      props.socket.on(\"call-entring\", () => {\n        setonCalling(true);\n      });\n      props.socket.emit('check-time', {\n        consultationId: props.teleconsultation.id\n      }, response => {\n        setdifference(response.diff);\n        setnow(response.now);\n        setonConsuting(response.isTime);\n      });\n    }\n  }, [props.socket]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: props.teleconsultation ? /*#__PURE__*/_jsxDEV(Row, {\n      className: \"justify-content-around m-0\",\n      children: /*#__PURE__*/_jsxDEV(Col, {\n        lg: \"12\",\n        className: \"bg-white p-0 discussion-container\",\n        children: [/*#__PURE__*/_jsxDEV(Row, {\n          className: \"m-0\",\n          children: /*#__PURE__*/_jsxDEV(InfoBar, {\n            onConsuting: onConsuting,\n            medecin: props.teleconsultation.medecin,\n            teleconsultation: props.teleconsultation\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 299,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 298,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(Row, {\n          className: \"discussion m-0\",\n          children: /*#__PURE__*/_jsxDEV(ProcessZone, _objectSpread({\n            onConsuting: onConsuting,\n            medecin: props.teleconsultation.medecin,\n            difference: difference,\n            now: now,\n            setonCalling: setonCalling,\n            onCalling: onCalling\n          }, props), void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 307,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 306,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 297,\n        columnNumber: 21\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 296,\n      columnNumber: 17\n    }, this) : null\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 293,\n    columnNumber: 9\n  }, this);\n}\n\nfunction ProcessZone(props) {\n  useEffect(() => {\n    if (navigator) {\n      if (navigator.permissions) {\n        navigator.permissions.query({\n          name: \"camera\"\n        }).then(res => console.log(res), e => console.log(e.name + \": \" + e.message)).catch(err => {\n          console.log(e.name + \": \" + e.message);\n        });\n        navigator.permissions.query({\n          name: \"microphone\"\n        }).then(({\n          state\n        }) => console.log(state), e => console.log(e.name + \": \" + e.message)); // navigator.mediaDevices.enumerateDevices()\n        // .then(devices => {\n        //     const filtered = devices.filter(device => device.kind === 'videoinput');\n        //     // console.log('Cameras found', filtered)\n        //     // callback(filtered);\n        // })\n        // .catch(err=> {\n        //     console.log(`Unable to fetsh stream ${err}`)\n        // })\n      }\n    }\n\n    return () => {};\n  }, []);\n\n  if (props.onCalling) {\n    return /*#__PURE__*/_jsxDEV(VideoCall, _objectSpread({}, props), void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 360,\n      columnNumber: 13\n    }, this);\n  }\n\n  if (props.onConsuting) {\n    return /*#__PURE__*/_jsxDEV(Chat, _objectSpread({}, props), void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 366,\n      columnNumber: 13\n    }, this);\n  }\n\n  switch (true) {\n    case props.difference > 0:\n      return /*#__PURE__*/_jsxDEV(FutureConsultation, {\n        difference: props.difference,\n        now: props.now\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 372,\n        columnNumber: 17\n      }, this);\n\n    case props.difference < 0:\n      return /*#__PURE__*/_jsxDEV(OldConsultation, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 376,\n        columnNumber: 17\n      }, this);\n\n    default:\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        children: /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \" Nous avons pas pus d\\xE9duire le cr\\xE9neau de cette consultation. Veillez rafr\\xE9chir la page pour r\\xE9ssayer \"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 381,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 380,\n        columnNumber: 17\n      }, this);\n  }\n}\n\nfunction Chat(props) {\n  const {\n    0: messages,\n    1: setMessages\n  } = useState([]);\n  const {\n    0: message,\n    1: setMessage\n  } = useState(\"\");\n\n  const sendMessage = event => {\n    event.preventDefault();\n\n    if (message) {\n      setMessage('');\n      let data = {\n        message: message,\n        type: \"text\",\n        sentBy: \"patient\",\n        sentTo: \"medecin\",\n        selectedUser: \"m\" + props.medecin.id,\n        consultationId: props.teleconsultation.id\n      };\n      setMessages(messages => [...messages, {\n        isSentByCurrentUser: true,\n        data\n      }]);\n      props.socket.emit('sendMessage', data, () => {});\n    }\n  };\n\n  useEffect(() => {\n    if (props.socket) {\n      props.socket.on('message', message => {\n        setMessages(messages => [...messages, message]);\n      });\n    }\n\n    return () => {\n      if (props.socket) {\n        props.socket.removeAllListeners('message');\n      }\n    };\n  }, [props.socket]);\n  return /*#__PURE__*/_jsxDEV(Col, {\n    lg: \"12\",\n    md: \"12\",\n    sm: \"12\",\n    xs: \"12\",\n    className: \"chat-messages p-0\",\n    children: [/*#__PURE__*/_jsxDEV(Messages, {\n      messages: messages,\n      user: props.medecin,\n      storedMessages: props.teleconsultation.messages\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 423,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(SendMessageForm, {\n      message: message,\n      setMessage: setMessage,\n      sendMessage: sendMessage,\n      active: props.teleconsultation.active\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 424,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 422,\n    columnNumber: 9\n  }, this);\n}\n\nfunction FutureConsultation({\n  difference,\n  now\n}) {\n  return /*#__PURE__*/_jsxDEV(Col, {\n    lg: \"12\",\n    md: \"12\",\n    sm: \"12\",\n    xs: \"12\",\n    className: \"chat-messages p-5\",\n    children: /*#__PURE__*/_jsxDEV(Row, {\n      className: \"justify-content-center align-items-center h-100\",\n      children: /*#__PURE__*/_jsxDEV(CountDown, {\n        difference: difference,\n        now: now\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 434,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 433,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 432,\n    columnNumber: 9\n  }, this);\n}\n\nfunction OldConsultation(props) {\n  return /*#__PURE__*/_jsxDEV(Col, {\n    lg: \"12\",\n    md: \"12\",\n    sm: \"12\",\n    xs: \"12\",\n    className: \"chat-messages p-0\",\n    children: /*#__PURE__*/_jsxDEV(Row, {\n      className: \"justify-content-center align-items-center h-100\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        children: /*#__PURE__*/_jsxDEV(\"h2\", {\n          children: \" consultation passer \"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 450,\n          columnNumber: 17\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 449,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 448,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 447,\n    columnNumber: 9\n  }, this);\n}","map":{"version":3,"sources":["C:/app/doctolive_code/patient-doctolive/pages/consultation/[id].js"],"names":["React","useEffect","useState","Config","Card","CardBody","Col","Row","Alert","Collapse","DocumentC","Messages","InfoBar","VideoCall","SendMessageForm","CountDown","Button","Checkbox","TextField","useRouter","useAuth","contentFR","contentEN","contentAR","getServerSideProps","context","req","cookies","getAppCookies","token","props","isAuth","res","fetch","BACKEND_URL","params","id","headers","data","json","teleconsultation","consultation","parsedItems","cookie","cookiesItems","split","forEach","parsedItem","decodeURI","ConsultationContainer","socket","addRapport","setAddRapport","fieldValidationErrors","setFieldValidationErrors","state","setState","isCompleted","response","setResponse","sending","success","donneIncorecte","router","locale","content","userData","handleSubmit","e","preventDefault","old","method","body","JSON","stringify","consultationId","then","r","error","validator","catch","console","log","validateField","handleChange","target","value","name","documents","nomError","report","labelNom","nom","prenomError","labelPrenom","description","labelEnd","errorSignup","successSignup","signup","ChatContainer","onConsuting","setonConsuting","onCalling","setonCalling","difference","setdifference","now","setnow","on","emit","diff","isTime","medecin","ProcessZone","navigator","permissions","query","message","err","Chat","messages","setMessages","setMessage","sendMessage","event","type","sentBy","sentTo","selectedUser","isSentByCurrentUser","removeAllListeners","active","FutureConsultation","OldConsultation"],"mappings":"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","sourcesContent":["import React, {useEffect, useState} from 'react'\r\n\r\n// import Config from 'Config'\r\nimport Config from './../../EndPoint';\r\n\r\nimport Card from './../../components/Card/Card'\r\nimport CardBody from './../../components/Card/CardBody'\r\n\r\nimport { Col,Row, Alert, Collapse } from 'react-bootstrap';\r\n\r\nimport DocumentC from './../../components/Documents/DocumentsC'\r\n\r\nimport Messages from './../../components/Chat/messages';\r\nimport InfoBar from './../../components/Chat/infoBar';\r\nimport VideoCall from './../../components/Chat/videoChat'\r\nimport SendMessageForm from './../../components/Chat/sendingMessage';\r\nimport CountDown from './../../components/Chat/CountDown/CountDown'\r\n\r\nimport Button from './../../components/CustomButtons/Button'\r\n\r\nimport Checkbox from './../../components/Checkbox/Checkbox'\r\nimport TextField from '@material-ui/core/TextField';\r\n\r\nimport { useRouter } from 'next/router'\r\nimport {useAuth} from './../../context/AuthContext'\r\n\r\n\r\nimport contentFR from './../../contentFR'\r\nimport contentEN from './../../contentEN'\r\nimport contentAR from './../../contentAR'\r\n\r\n// export async function getServerSideProps(context) {\r\n//     const res = await fetch(`${Config.BACKEND_URL}/consultation/${context.params.id}`)\r\n//     const data = await res.json();\r\n//     console.log(data)\r\n//     if(!data){\r\n//         return {\r\n//             props: {teleconsultation: {}},\r\n//           }\r\n//     }\r\n//     return {\r\n//       props: {teleconsultation: data.consultation},\r\n//     }\r\n// }\r\n\r\nexport async function getServerSideProps(context) {\r\n    const { req } = context;\r\n   \r\n    const cookies = getAppCookies(req);\r\n\r\n    if(!cookies.token){\r\n        return {\r\n            props: {\r\n                isAuth: false\r\n            },\r\n          }\r\n    }else {\r\n        const res = await fetch(`${Config.BACKEND_URL}/consultation/${context.params.id}`, {\r\n            headers: {\r\n                'Accept': 'application/json', \r\n                'Content-Type': 'application/json',\r\n                'Authorization': `token ${cookies.token}`,\r\n              },\r\n        })\r\n        const data = await res.json()\r\n\r\n        return {\r\n            props: {\r\n              isAuth: true,\r\n              teleconsultation: data.consultation\r\n            },\r\n        }\r\n    }\r\n   \r\n    \r\n}\r\n\r\nfunction getAppCookies(req) {\r\n    const parsedItems = {};\r\n    if (req.headers.cookie) {\r\n      const cookiesItems = req.headers.cookie.split('; ');\r\n      cookiesItems.forEach(cookies => {\r\n        const parsedItem = cookies.split('=');\r\n        parsedItems[parsedItem[0]] = decodeURI(parsedItem[1]);\r\n      });\r\n    }\r\n    return parsedItems;\r\n  }\r\n  \r\nexport default function ConsultationContainer({teleconsultation, socket}) {\r\n\r\n    const [addRapport, setAddRapport] = useState(false)\r\n    const [fieldValidationErrors, setFieldValidationErrors] = useState({})\r\n    const [state, setState] = useState({isCompleted: false})\r\n    const [response, setResponse] = useState({\r\n        sending:false,\r\n        success:false,   \r\n        donneIncorecte: false                 \r\n    })\r\n    const router = useRouter();\r\n    const {locale} = router;\r\n    const content = locale === \"ar\" ? contentAR : locale === \"en\" ? contentEN : contentFR;\r\n    const { userData } = useAuth();\r\n\r\n\r\n\r\n    const handleSubmit = (e) => {\r\n        e.preventDefault();\r\n        setResponse(old =>  { return {...old, sending: true}});\r\n\r\n        let data = state;\r\n\r\n        fetch(`${Config.BACKEND_URL}/feedback`,{\r\n            method:\"post\",\r\n            headers: {\r\n                'Content-Type': 'application/json',\r\n                'Authorization': `token ${userData.token}`,\r\n            },\r\n            body:JSON.stringify({...data, consultationId: teleconsultation.id })\r\n        })\r\n        .then(\r\n            (r) => r.json()\r\n            .then(res => {\r\n\r\n                if(!res.error){\r\n                    // props.setUserData(res);\r\n                    setResponse({sending: false, success:true, donneIncorecte: false});\r\n                    \r\n                    \r\n                }else {\r\n                    setResponse({sending: false, success:false, donneIncorecte:true})\r\n                    if(res.validator){\r\n\r\n                    }else{\r\n\r\n                    }\r\n                }\r\n           \r\n            })\r\n            ).catch(error =>{ \r\n                console.log(error)\r\n                setResponse({sending: false, success:false, donneIncorecte:true})\r\n            })\r\n    }\r\n\r\n    \r\n\r\n    const validateField = () => {\r\n\r\n    }\r\n\r\n    const handleChange = ({target : {value, name}}) => {\r\n\r\n        if(name===\"isCompleted\"){\r\n            setState(old => {return { ...old, isCompleted: !state.isCompleted}}) ;\r\n        }else {\r\n            setState(old => {return { ...old, [name]: value}}) ;\r\n        }\r\n\r\n    }\r\n       \r\n    return (\r\n        <div className=\"teleconsultation\">\r\n            <Row className=\"m-0\">\r\n               <Col lg=\"6\" md={12} sm={12} xs={12}>\r\n                    <ChatContainer teleconsultation = {teleconsultation} socket={socket}  />\r\n               </Col>\r\n               <Col lg=\"6\" md={12} sm={12} xs={12}>\r\n                    <Card>\r\n                        <CardBody>\r\n                        \r\n                            <div>  \r\n                                <strong> Document à partager dans cette consultation </strong>\r\n                                <DocumentC documents={teleconsultation? teleconsultation.documents:[]} socket={socket} consultation={teleconsultation} />\r\n                            </div>\r\n                               \r\n                        </CardBody>\r\n                    </Card>\r\n                    <Card>\r\n                        <CardBody>\r\n                        \r\n                            <div>  \r\n                            <strong> Ajouter un rapport  </strong>\r\n                            {\r\n                                addRapport ? \r\n                                <div> \r\n                                    <form onSubmit={handleSubmit} autoComplete=\"off\">\r\n            \r\n                                        <Row>\r\n                                                <Col xs=\"12\" md=\"6\" className=\"mt-3\"> \r\n                                                    <TextField\r\n                                                        error={fieldValidationErrors.nomError}\r\n                                                        placeholder=\"\"\r\n                                                        label={content.report.labelNom}\r\n                                                        required={false}\r\n                                                        variant=\"outlined\"\r\n                                                        name=\"type\"\r\n                                                        onBlur={validateField} \r\n                                                        value={state.nom}\r\n                                                        onChange={handleChange} \r\n                                                    />\r\n                                                </Col>\r\n                                                <Col xs=\"12\" md=\"12\" className=\"mt-3\" > \r\n                                                    <TextField\r\n                                                        placeholder=\"\"\r\n                                                        variant=\"outlined\"\r\n                                                        required={false}\r\n                                                        error={fieldValidationErrors.prenomError}\r\n                                                        label={content.report.labelPrenom}\r\n                                                        onBlur={validateField} \r\n                                                        name=\"description\"\r\n                                                        fullWidth\r\n                                                        value={state.description}\r\n                                                        onChange={handleChange} \r\n                                                    />\r\n                                                \r\n                                                </Col>\r\n                                                <Col xs=\"12\" md=\"6\" className=\"mt-3\" > \r\n                                                    <Checkbox\r\n                                                        placeholder=\"\"\r\n                                                        variant=\"outlined\"\r\n                                                        required={false}\r\n                                                        error={fieldValidationErrors.prenomError}\r\n                                                        label={content.report.labelEnd}\r\n                                                        name=\"isCompleted\"\r\n                                                        checked={state.isCompleted}\r\n                                                        rtl={locale === \"ar\"?  true : false}\r\n                                                        onChange={handleChange} \r\n                                                    />\r\n                                                </Col>\r\n                                        </Row>\r\n                                        <Row className=\"justify-content-center\">\r\n                                            <Collapse in={response.donneIncorecte}>\r\n                                                <div className=\"mt-5\">\r\n                                                    <Alert  variant=\"danger\">\r\n                                                        {content.report.errorSignup}\r\n                                                    </Alert>\r\n                                                </div>\r\n                                            </Collapse>\r\n                                        </Row>\r\n                                        <Row className=\"justify-content-center\">\r\n                                            <Collapse in={response.success}>\r\n                                                <div className=\"mt-5\">\r\n                                                    <Alert  variant=\"success\">\r\n                                                        {content.report.successSignup}\r\n                                                    </Alert>\r\n                                                </div>\r\n                                            </Collapse>\r\n                                        </Row>\r\n                                        <Row className=\"align-items-center justify-content-around mt-4 \">\r\n                                            <Button type=\"submit\" color=\"primary\"> {content.report.signup} </Button>\r\n                                        </Row>\r\n                                    </form>\r\n                                </div>\r\n                                : \r\n                                <div>\r\n                                    <Button color=\"primary\" onClick={() => setAddRapport(true)}> Ajouter rapport </Button>\r\n                                </div>\r\n                            }\r\n                            </div>\r\n                               \r\n                        </CardBody>\r\n                    </Card>\r\n                </Col>\r\n            </Row>\r\n        </div>\r\n    )\r\n}\r\n\r\nfunction ChatContainer(props) {\r\n    const [onConsuting, setonConsuting] = useState(false);\r\n    const [onCalling, setonCalling] = useState(false);\r\n    const [difference, setdifference] = useState(0);\r\n    const [now, setnow] = useState(0);\r\n\r\n    \r\n    useEffect(()=>{\r\n    if(props.socket){\r\n        props.socket.on(\"call-entring\", () => {\r\n            setonCalling(true);\r\n        });\r\n\r\n        props.socket.emit('check-time', {consultationId: props.teleconsultation.id}, (response)=> { \r\n            setdifference(response.diff);\r\n            setnow(response.now)\r\n            setonConsuting(response.isTime);\r\n        });  \r\n    }\r\n      \r\n    }, [props.socket])\r\n\r\n    return (\r\n        <div>\r\n            {\r\n                props.teleconsultation?\r\n                <Row className=\"justify-content-around m-0\">\r\n                    <Col lg=\"12\" className = \"bg-white p-0 discussion-container\">\r\n                        <Row className=\"m-0\">\r\n                            <InfoBar\r\n                                onConsuting={onConsuting} \r\n                                medecin={props.teleconsultation.medecin} \r\n                                teleconsultation={props.teleconsultation}\r\n                            />\r\n                        </Row>\r\n                    \r\n                        <Row className=\"discussion m-0\">\r\n                            <ProcessZone \r\n                            onConsuting={onConsuting} \r\n                            medecin={props.teleconsultation.medecin}\r\n                            difference={difference}\r\n                            now={now}\r\n                            setonCalling={setonCalling}\r\n                            onCalling={onCalling}\r\n                            {...props}\r\n                             />\r\n                        </Row>\r\n                    </Col>\r\n                </Row> \r\n                : null\r\n            }\r\n            \r\n        </div>\r\n    )\r\n}\r\nfunction ProcessZone(props){\r\n    \r\n    useEffect(() => {\r\n        if(navigator){\r\n            if(navigator.permissions){\r\n                navigator.permissions.query({name: \"camera\"})\r\n                .then((res) => console.log(res),\r\n                    e => console.log(e.name +\": \"+ e.message))\r\n                .catch(err => {\r\n                    console.log(e.name +\": \"+ e.message)\r\n                })\r\n        \r\n              navigator.permissions.query({name: \"microphone\"})\r\n              .then(({state}) => console.log(state),\r\n            e => console.log(e.name +\": \"+ e.message));\r\n          \r\n                // navigator.mediaDevices.enumerateDevices()\r\n                // .then(devices => {\r\n                //     const filtered = devices.filter(device => device.kind === 'videoinput');\r\n                //     // console.log('Cameras found', filtered)\r\n                //     // callback(filtered);\r\n                // })\r\n                // .catch(err=> {\r\n                //     console.log(`Unable to fetsh stream ${err}`)\r\n                // })\r\n            }\r\n          \r\n        }\r\n       \r\n        return () => {\r\n            \r\n        }\r\n    }, [])\r\n    if(props.onCalling) {\r\n        return(\r\n            <VideoCall {...props} />\r\n        )\r\n    }\r\n\r\n    if(props.onConsuting) {\r\n        return(\r\n            <Chat {...props} />\r\n        )\r\n    }\r\n    switch (true) {\r\n        case props.difference > 0:\r\n            return (\r\n                <FutureConsultation difference={props.difference}now={props.now} />\r\n            )\r\n        case props.difference < 0:\r\n            return (\r\n                <OldConsultation />\r\n            )\r\n        default:\r\n            return(\r\n                <div>\r\n                    <p> Nous avons pas pus déduire le créneau de cette consultation. Veillez rafréchir la page pour réssayer </p>\r\n                </div>\r\n            )\r\n    }\r\n   \r\n}\r\n\r\n\r\n  \r\n\r\nfunction Chat(props) {\r\n    const [messages, setMessages] = useState([]);\r\n    const [message, setMessage] = useState(\"\");\r\n    \r\n    const sendMessage = (event) => {\r\n        event.preventDefault();\r\n        if(message) {\r\n          setMessage('')\r\n          let data = {message: message, type:\"text\", sentBy:\"patient\", sentTo: \"medecin\", selectedUser: \"m\" + props.medecin.id, consultationId: props.teleconsultation.id };\r\n          setMessages(messages => [ ...messages, {isSentByCurrentUser: true,  data} ]);\r\n           props.socket.emit('sendMessage', data, ()=> { });    \r\n        }\r\n    }\r\n\r\n    useEffect(()=>{\r\n        if(props.socket){\r\n            props.socket.on('message', (message) => {\r\n                setMessages(messages => [ ...messages, message ]);\r\n            });\r\n        \r\n\r\n        }\r\n        return () => {\r\n            if(props.socket){\r\n                props.socket.removeAllListeners('message')\r\n            }\r\n            \r\n        }\r\n    }, [props.socket])\r\n\r\n    return(\r\n        <Col lg=\"12\" md=\"12\" sm=\"12\" xs=\"12\" className=\"chat-messages p-0\">\r\n            <Messages messages={messages} user={props.medecin} storedMessages={props.teleconsultation.messages} />\r\n            <SendMessageForm message={message} setMessage={setMessage} sendMessage={sendMessage} active={props.teleconsultation.active} />\r\n        </Col>\r\n    )\r\n}\r\n\r\nfunction FutureConsultation({difference,now}) {\r\n\r\n    return(\r\n        <Col lg=\"12\" md=\"12\" sm=\"12\" xs=\"12\" className=\"chat-messages p-5\">\r\n            <Row className=\"justify-content-center align-items-center h-100\">\r\n                <CountDown \r\n                    difference={difference} \r\n                    now={now}\r\n                />\r\n            </Row>\r\n        </Col>\r\n    )\r\n}\r\n\r\nfunction OldConsultation(props) {\r\n   \r\n\r\n    return(\r\n        <Col lg=\"12\" md=\"12\" sm=\"12\" xs=\"12\" className=\"chat-messages p-0\">\r\n            <Row className=\"justify-content-center align-items-center h-100\">\r\n                <div>\r\n                <h2> consultation passer </h2>\r\n                </div>\r\n            </Row>\r\n        </Col>\r\n    )\r\n}\r\n"]},"metadata":{},"sourceType":"module"}