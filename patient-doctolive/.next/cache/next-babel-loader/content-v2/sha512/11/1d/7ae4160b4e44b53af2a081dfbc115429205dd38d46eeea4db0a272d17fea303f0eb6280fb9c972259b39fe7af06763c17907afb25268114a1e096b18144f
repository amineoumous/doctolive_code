{"ast":null,"code":"import _toConsumableArray from \"C:/app/doctolive_code/patient-doctolive/node_modules/next/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport _defineProperty from \"C:/app/doctolive_code/patient-doctolive/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\n\nvar _jsxFileName = \"C:\\\\app\\\\doctolive_code\\\\patient-doctolive\\\\pages\\\\consultation\\\\[id].js\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$(),\n    _s3 = $RefreshSig$(),\n    _s4 = $RefreshSig$();\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useEffect, useState } from 'react'; // import Config from 'Config'\n\nimport Config from './../../EndPoint';\nimport Card from './../../components/Card/Card';\nimport CardBody from './../../components/Card/CardBody';\nimport { Col, Row, Alert, Collapse } from 'react-bootstrap';\nimport DocumentC from './../../components/Documents/DocumentsC';\nimport Messages from './../../components/Chat/messages';\nimport InfoBar from './../../components/Chat/infoBar';\nimport VideoCall from './../../components/Chat/videoChat';\nimport SendMessageForm from './../../components/Chat/sendingMessage';\nimport CountDown from './../../components/Chat/CountDown/CountDown';\nimport Button from './../../components/CustomButtons/Button';\nimport Checkbox from './../../components/Checkbox/Checkbox';\nimport TextField from '@material-ui/core/TextField';\nimport { useRouter } from 'next/router';\nimport { useAuth } from './../../context/AuthContext';\nimport contentFR from './../../contentFR';\nimport contentEN from './../../contentEN';\nimport contentAR from './../../contentAR'; // export async function getServerSideProps(context) {\n//     const res = await fetch(`${Config.BACKEND_URL}/consultation/${context.params.id}`)\n//     const data = await res.json();\n//     console.log(data)\n//     if(!data){\n//         return {\n//             props: {teleconsultation: {}},\n//           }\n//     }\n//     return {\n//       props: {teleconsultation: data.consultation},\n//     }\n// }\n\nexport var __N_SSP = true;\nexport default function ConsultationContainer(_ref) {\n  _s();\n\n  var teleconsultation = _ref.teleconsultation,\n      socket = _ref.socket;\n\n  var _useState = useState(false),\n      addRapport = _useState[0],\n      setAddRapport = _useState[1];\n\n  var _useState2 = useState({}),\n      fieldValidationErrors = _useState2[0],\n      setFieldValidationErrors = _useState2[1];\n\n  var _useState3 = useState({\n    isCompleted: false\n  }),\n      state = _useState3[0],\n      setState = _useState3[1];\n\n  var _useState4 = useState({\n    sending: false,\n    success: false,\n    donneIncorecte: false\n  }),\n      response = _useState4[0],\n      setResponse = _useState4[1];\n\n  var router = useRouter();\n  var locale = router.locale;\n  var content = locale === \"ar\" ? contentAR : locale === \"en\" ? contentEN : contentFR;\n\n  var _useAuth = useAuth(),\n      userData = _useAuth.userData;\n\n  var handleSubmit = function handleSubmit(e) {\n    e.preventDefault();\n    setResponse(function (old) {\n      return _objectSpread(_objectSpread({}, old), {}, {\n        sending: true\n      });\n    });\n    var data = state;\n    fetch(\"\".concat(Config.BACKEND_URL, \"/feedback\"), {\n      method: \"post\",\n      headers: {\n        'Content-Type': 'application/json',\n        'Authorization': \"token \".concat(userData.token)\n      },\n      body: JSON.stringify(_objectSpread(_objectSpread({}, data), {}, {\n        consultationId: teleconsultation.id\n      }))\n    }).then(function (r) {\n      return r.json().then(function (res) {\n        if (!res.error) {\n          // props.setUserData(res);\n          setResponse({\n            sending: false,\n            success: true,\n            donneIncorecte: false\n          });\n        } else {\n          setResponse({\n            sending: false,\n            success: false,\n            donneIncorecte: true\n          });\n\n          if (res.validator) {} else {}\n        }\n      });\n    })[\"catch\"](function (error) {\n      console.log(error);\n      setResponse({\n        sending: false,\n        success: false,\n        donneIncorecte: true\n      });\n    });\n  };\n\n  var validateField = function validateField() {};\n\n  var handleChange = function handleChange(_ref2) {\n    var _ref2$target = _ref2.target,\n        value = _ref2$target.value,\n        name = _ref2$target.name;\n\n    if (name === \"isCompleted\") {\n      setState(function (old) {\n        return _objectSpread(_objectSpread({}, old), {}, {\n          isCompleted: !state.isCompleted\n        });\n      });\n    } else {\n      setState(function (old) {\n        return _objectSpread(_objectSpread({}, old), {}, _defineProperty({}, name, value));\n      });\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"teleconsultation\",\n    children: /*#__PURE__*/_jsxDEV(Row, {\n      className: \"m-0\",\n      children: [/*#__PURE__*/_jsxDEV(Col, {\n        lg: \"6\",\n        md: 12,\n        sm: 12,\n        xs: 12,\n        children: /*#__PURE__*/_jsxDEV(ChatContainer, {\n          teleconsultation: teleconsultation,\n          socket: socket\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 166,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 165,\n        columnNumber: 16\n      }, this), /*#__PURE__*/_jsxDEV(Col, {\n        lg: \"6\",\n        md: 12,\n        sm: 12,\n        xs: 12,\n        children: [/*#__PURE__*/_jsxDEV(Card, {\n          children: /*#__PURE__*/_jsxDEV(CardBody, {\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \" Document \\xE0 partager dans cette consultation \"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 173,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(DocumentC, {\n                documents: teleconsultation ? teleconsultation.documents : [],\n                socket: socket,\n                consultation: teleconsultation\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 174,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 172,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 170,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 169,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Card, {\n          children: /*#__PURE__*/_jsxDEV(CardBody, {\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \" Ajouter un rapport  \"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 183,\n                columnNumber: 29\n              }, this), addRapport ? /*#__PURE__*/_jsxDEV(\"div\", {\n                children: /*#__PURE__*/_jsxDEV(\"form\", {\n                  onSubmit: handleSubmit,\n                  autoComplete: \"off\",\n                  children: [/*#__PURE__*/_jsxDEV(Row, {\n                    children: [/*#__PURE__*/_jsxDEV(Col, {\n                      xs: \"12\",\n                      md: \"6\",\n                      className: \"mt-3\",\n                      children: /*#__PURE__*/_jsxDEV(TextField, {\n                        error: fieldValidationErrors.nomError,\n                        placeholder: \"\",\n                        label: content.report.labelNom,\n                        required: false,\n                        variant: \"outlined\",\n                        name: \"type\",\n                        onBlur: validateField,\n                        value: state.nom,\n                        onChange: handleChange\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 191,\n                        columnNumber: 53\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 190,\n                      columnNumber: 49\n                    }, this), /*#__PURE__*/_jsxDEV(Col, {\n                      xs: \"12\",\n                      md: \"12\",\n                      className: \"mt-3\",\n                      children: /*#__PURE__*/_jsxDEV(TextField, {\n                        placeholder: \"\",\n                        variant: \"outlined\",\n                        required: false,\n                        error: fieldValidationErrors.prenomError,\n                        label: content.report.labelPrenom,\n                        onBlur: validateField,\n                        name: \"description\",\n                        fullWidth: true,\n                        value: state.description,\n                        onChange: handleChange\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 204,\n                        columnNumber: 53\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 203,\n                      columnNumber: 49\n                    }, this), /*#__PURE__*/_jsxDEV(Col, {\n                      xs: \"12\",\n                      md: \"6\",\n                      className: \"mt-3\",\n                      children: /*#__PURE__*/_jsxDEV(Checkbox, {\n                        placeholder: \"\",\n                        variant: \"outlined\",\n                        required: false,\n                        error: fieldValidationErrors.prenomError,\n                        label: content.report.labelEnd,\n                        name: \"isCompleted\",\n                        checked: state.isCompleted,\n                        rtl: locale === \"ar\" ? true : false,\n                        onChange: handleChange\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 219,\n                        columnNumber: 53\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 218,\n                      columnNumber: 49\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 189,\n                    columnNumber: 41\n                  }, this), /*#__PURE__*/_jsxDEV(Row, {\n                    className: \"justify-content-center\",\n                    children: /*#__PURE__*/_jsxDEV(Collapse, {\n                      \"in\": response.donneIncorecte,\n                      children: /*#__PURE__*/_jsxDEV(\"div\", {\n                        className: \"mt-5\",\n                        children: /*#__PURE__*/_jsxDEV(Alert, {\n                          variant: \"danger\",\n                          children: content.report.errorSignup\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 235,\n                          columnNumber: 53\n                        }, this)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 234,\n                        columnNumber: 49\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 233,\n                      columnNumber: 45\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 232,\n                    columnNumber: 41\n                  }, this), /*#__PURE__*/_jsxDEV(Row, {\n                    className: \"justify-content-center\",\n                    children: /*#__PURE__*/_jsxDEV(Collapse, {\n                      \"in\": response.success,\n                      children: /*#__PURE__*/_jsxDEV(\"div\", {\n                        className: \"mt-5\",\n                        children: /*#__PURE__*/_jsxDEV(Alert, {\n                          variant: \"success\",\n                          children: content.report.successSignup\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 244,\n                          columnNumber: 53\n                        }, this)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 243,\n                        columnNumber: 49\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 242,\n                      columnNumber: 45\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 241,\n                    columnNumber: 41\n                  }, this), /*#__PURE__*/_jsxDEV(Row, {\n                    className: \"align-items-center justify-content-around mt-4 \",\n                    children: /*#__PURE__*/_jsxDEV(Button, {\n                      type: \"submit\",\n                      color: \"primary\",\n                      children: [\" \", content.report.signup, \" \"]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 251,\n                      columnNumber: 45\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 250,\n                    columnNumber: 41\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 187,\n                  columnNumber: 37\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 186,\n                columnNumber: 33\n              }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n                children: /*#__PURE__*/_jsxDEV(Button, {\n                  color: \"primary\",\n                  onClick: function onClick() {\n                    return setAddRapport(true);\n                  },\n                  children: \" Ajouter rapport \"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 257,\n                  columnNumber: 37\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 256,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 182,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 180,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 179,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 168,\n        columnNumber: 16\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 164,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 163,\n    columnNumber: 9\n  }, this);\n}\n\n_s(ConsultationContainer, \"b9JQR26R0tpK4RLLYEuXJWONSp0=\", false, function () {\n  return [useRouter, useAuth];\n});\n\n_c = ConsultationContainer;\n\nfunction ChatContainer(props) {\n  _s2();\n\n  var _useState5 = useState(false),\n      onConsuting = _useState5[0],\n      setonConsuting = _useState5[1];\n\n  var _useState6 = useState(false),\n      onCalling = _useState6[0],\n      setonCalling = _useState6[1];\n\n  var _useState7 = useState(0),\n      difference = _useState7[0],\n      setdifference = _useState7[1];\n\n  var _useState8 = useState(0),\n      now = _useState8[0],\n      setnow = _useState8[1];\n\n  useEffect(function () {\n    if (props.socket) {\n      props.socket.on(\"call-entring\", function () {\n        setonCalling(true);\n      });\n      props.socket.emit('check-time', {\n        consultationId: props.teleconsultation.id\n      }, function (response) {\n        setdifference(response.diff);\n        setnow(response.now);\n        setonConsuting(response.isTime);\n      });\n    }\n  }, [props.socket]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: props.teleconsultation ? /*#__PURE__*/_jsxDEV(Row, {\n      className: \"justify-content-around m-0\",\n      children: /*#__PURE__*/_jsxDEV(Col, {\n        lg: \"12\",\n        className: \"bg-white p-0 discussion-container\",\n        children: [/*#__PURE__*/_jsxDEV(Row, {\n          className: \"m-0\",\n          children: /*#__PURE__*/_jsxDEV(InfoBar, {\n            onConsuting: onConsuting,\n            medecin: props.teleconsultation.medecin,\n            teleconsultation: props.teleconsultation\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 299,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 298,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(Row, {\n          className: \"discussion m-0\",\n          children: /*#__PURE__*/_jsxDEV(ProcessZone, _objectSpread({\n            onConsuting: onConsuting,\n            medecin: props.teleconsultation.medecin,\n            difference: difference,\n            now: now,\n            setonCalling: setonCalling,\n            onCalling: onCalling\n          }, props), void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 307,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 306,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 297,\n        columnNumber: 21\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 296,\n      columnNumber: 17\n    }, this) : null\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 293,\n    columnNumber: 9\n  }, this);\n}\n\n_s2(ChatContainer, \"BlM7dx9YzY6ktRs5htgbtW1tZrs=\");\n\n_c2 = ChatContainer;\n\nfunction ProcessZone(props) {\n  _s3();\n\n  useEffect(function () {\n    if (navigator) {\n      if (navigator.permissions) {\n        navigator.permissions.query({\n          name: \"camera\"\n        }).then(function (res) {\n          return console.log(res);\n        }, function (e) {\n          return console.log(e.name + \": \" + e.message);\n        })[\"catch\"](function (err) {\n          console.log(e.name + \": \" + e.message);\n        });\n        navigator.permissions.query({\n          name: \"microphone\"\n        }).then(function (_ref3) {\n          var state = _ref3.state;\n          return console.log(state);\n        }, function (e) {\n          return console.log(e.name + \": \" + e.message);\n        }); // navigator.mediaDevices.enumerateDevices()\n        // .then(devices => {\n        //     const filtered = devices.filter(device => device.kind === 'videoinput');\n        //     // console.log('Cameras found', filtered)\n        //     // callback(filtered);\n        // })\n        // .catch(err=> {\n        //     console.log(`Unable to fetsh stream ${err}`)\n        // })\n      }\n    }\n\n    return function () {};\n  }, []);\n\n  if (props.onCalling) {\n    return /*#__PURE__*/_jsxDEV(VideoCall, _objectSpread({}, props), void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 360,\n      columnNumber: 13\n    }, this);\n  }\n\n  if (props.onConsuting) {\n    return /*#__PURE__*/_jsxDEV(Chat, _objectSpread({}, props), void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 366,\n      columnNumber: 13\n    }, this);\n  }\n\n  switch (true) {\n    case props.difference > 0:\n      return /*#__PURE__*/_jsxDEV(FutureConsultation, {\n        difference: props.difference,\n        now: props.now\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 372,\n        columnNumber: 17\n      }, this);\n\n    case props.difference < 0:\n      return /*#__PURE__*/_jsxDEV(OldConsultation, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 376,\n        columnNumber: 17\n      }, this);\n\n    default:\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        children: /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \" Nous avons pas pus d\\xE9duire le cr\\xE9neau de cette consultation. Veillez rafr\\xE9chir la page pour r\\xE9ssayer \"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 381,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 380,\n        columnNumber: 17\n      }, this);\n  }\n}\n\n_s3(ProcessZone, \"OD7bBpZva5O2jO+Puf00hKivP7c=\");\n\n_c3 = ProcessZone;\n\nfunction Chat(props) {\n  _s4();\n\n  var _useState9 = useState([]),\n      messages = _useState9[0],\n      setMessages = _useState9[1];\n\n  var _useState10 = useState(\"\"),\n      message = _useState10[0],\n      setMessage = _useState10[1];\n\n  var sendMessage = function sendMessage(event) {\n    event.preventDefault();\n\n    if (message) {\n      setMessage('');\n      var data = {\n        message: message,\n        type: \"text\",\n        sentBy: \"patient\",\n        sentTo: \"medecin\",\n        selectedUser: \"m\" + props.medecin.id,\n        consultationId: props.teleconsultation.id\n      };\n      setMessages(function (messages) {\n        return [].concat(_toConsumableArray(messages), [{\n          isSentByCurrentUser: true,\n          data: data\n        }]);\n      });\n      props.socket.emit('sendMessage', data, function () {});\n    }\n  };\n\n  useEffect(function () {\n    if (props.socket) {\n      props.socket.on('message', function (message) {\n        setMessages(function (messages) {\n          return [].concat(_toConsumableArray(messages), [message]);\n        });\n      });\n    }\n\n    return function () {\n      if (props.socket) {\n        props.socket.removeAllListeners('message');\n      }\n    };\n  }, [props.socket]);\n  return /*#__PURE__*/_jsxDEV(Col, {\n    lg: \"12\",\n    md: \"12\",\n    sm: \"12\",\n    xs: \"12\",\n    className: \"chat-messages p-0\",\n    children: [/*#__PURE__*/_jsxDEV(Messages, {\n      messages: messages,\n      user: props.medecin,\n      storedMessages: props.teleconsultation.messages\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 423,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(SendMessageForm, {\n      message: message,\n      setMessage: setMessage,\n      sendMessage: sendMessage,\n      active: props.teleconsultation.active\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 424,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 422,\n    columnNumber: 9\n  }, this);\n}\n\n_s4(Chat, \"cirg1XNVuY5I7aqZjd23CdWZMY0=\");\n\n_c4 = Chat;\n\nfunction FutureConsultation(_ref4) {\n  var difference = _ref4.difference,\n      now = _ref4.now;\n  return /*#__PURE__*/_jsxDEV(Col, {\n    lg: \"12\",\n    md: \"12\",\n    sm: \"12\",\n    xs: \"12\",\n    className: \"chat-messages p-5\",\n    children: /*#__PURE__*/_jsxDEV(Row, {\n      className: \"justify-content-center align-items-center h-100\",\n      children: /*#__PURE__*/_jsxDEV(CountDown, {\n        difference: difference,\n        now: now\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 434,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 433,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 432,\n    columnNumber: 9\n  }, this);\n}\n\n_c5 = FutureConsultation;\n\nfunction OldConsultation(props) {\n  return /*#__PURE__*/_jsxDEV(Col, {\n    lg: \"12\",\n    md: \"12\",\n    sm: \"12\",\n    xs: \"12\",\n    className: \"chat-messages p-0\",\n    children: /*#__PURE__*/_jsxDEV(Row, {\n      className: \"justify-content-center align-items-center h-100\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        children: /*#__PURE__*/_jsxDEV(\"h2\", {\n          children: \" consultation passer \"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 450,\n          columnNumber: 17\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 449,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 448,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 447,\n    columnNumber: 9\n  }, this);\n}\n\n_c6 = OldConsultation;\n\nvar _c, _c2, _c3, _c4, _c5, _c6;\n\n$RefreshReg$(_c, \"ConsultationContainer\");\n$RefreshReg$(_c2, \"ChatContainer\");\n$RefreshReg$(_c3, \"ProcessZone\");\n$RefreshReg$(_c4, \"Chat\");\n$RefreshReg$(_c5, \"FutureConsultation\");\n$RefreshReg$(_c6, \"OldConsultation\");","map":{"version":3,"sources":["C:/app/doctolive_code/patient-doctolive/pages/consultation/[id].js"],"names":["React","useEffect","useState","Config","Card","CardBody","Col","Row","Alert","Collapse","DocumentC","Messages","InfoBar","VideoCall","SendMessageForm","CountDown","Button","Checkbox","TextField","useRouter","useAuth","contentFR","contentEN","contentAR","ConsultationContainer","teleconsultation","socket","addRapport","setAddRapport","fieldValidationErrors","setFieldValidationErrors","isCompleted","state","setState","sending","success","donneIncorecte","response","setResponse","router","locale","content","userData","handleSubmit","e","preventDefault","old","data","fetch","BACKEND_URL","method","headers","token","body","JSON","stringify","consultationId","id","then","r","json","res","error","validator","console","log","validateField","handleChange","target","value","name","documents","nomError","report","labelNom","nom","prenomError","labelPrenom","description","labelEnd","errorSignup","successSignup","signup","ChatContainer","props","onConsuting","setonConsuting","onCalling","setonCalling","difference","setdifference","now","setnow","on","emit","diff","isTime","medecin","ProcessZone","navigator","permissions","query","message","err","Chat","messages","setMessages","setMessage","sendMessage","event","type","sentBy","sentTo","selectedUser","isSentByCurrentUser","removeAllListeners","active","FutureConsultation","OldConsultation"],"mappings":"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","sourcesContent":["import React, {useEffect, useState} from 'react'\r\n\r\n// import Config from 'Config'\r\nimport Config from './../../EndPoint';\r\n\r\nimport Card from './../../components/Card/Card'\r\nimport CardBody from './../../components/Card/CardBody'\r\n\r\nimport { Col,Row, Alert, Collapse } from 'react-bootstrap';\r\n\r\nimport DocumentC from './../../components/Documents/DocumentsC'\r\n\r\nimport Messages from './../../components/Chat/messages';\r\nimport InfoBar from './../../components/Chat/infoBar';\r\nimport VideoCall from './../../components/Chat/videoChat'\r\nimport SendMessageForm from './../../components/Chat/sendingMessage';\r\nimport CountDown from './../../components/Chat/CountDown/CountDown'\r\n\r\nimport Button from './../../components/CustomButtons/Button'\r\n\r\nimport Checkbox from './../../components/Checkbox/Checkbox'\r\nimport TextField from '@material-ui/core/TextField';\r\n\r\nimport { useRouter } from 'next/router'\r\nimport {useAuth} from './../../context/AuthContext'\r\n\r\n\r\nimport contentFR from './../../contentFR'\r\nimport contentEN from './../../contentEN'\r\nimport contentAR from './../../contentAR'\r\n\r\n// export async function getServerSideProps(context) {\r\n//     const res = await fetch(`${Config.BACKEND_URL}/consultation/${context.params.id}`)\r\n//     const data = await res.json();\r\n//     console.log(data)\r\n//     if(!data){\r\n//         return {\r\n//             props: {teleconsultation: {}},\r\n//           }\r\n//     }\r\n//     return {\r\n//       props: {teleconsultation: data.consultation},\r\n//     }\r\n// }\r\n\r\nexport async function getServerSideProps(context) {\r\n    const { req } = context;\r\n   \r\n    const cookies = getAppCookies(req);\r\n\r\n    if(!cookies.token){\r\n        return {\r\n            props: {\r\n                isAuth: false\r\n            },\r\n          }\r\n    }else {\r\n        const res = await fetch(`${Config.BACKEND_URL}/consultation/${context.params.id}`, {\r\n            headers: {\r\n                'Accept': 'application/json', \r\n                'Content-Type': 'application/json',\r\n                'Authorization': `token ${cookies.token}`,\r\n              },\r\n        })\r\n        const data = await res.json()\r\n\r\n        return {\r\n            props: {\r\n              isAuth: true,\r\n              teleconsultation: data.consultation\r\n            },\r\n        }\r\n    }\r\n   \r\n    \r\n}\r\n\r\nfunction getAppCookies(req) {\r\n    const parsedItems = {};\r\n    if (req.headers.cookie) {\r\n      const cookiesItems = req.headers.cookie.split('; ');\r\n      cookiesItems.forEach(cookies => {\r\n        const parsedItem = cookies.split('=');\r\n        parsedItems[parsedItem[0]] = decodeURI(parsedItem[1]);\r\n      });\r\n    }\r\n    return parsedItems;\r\n  }\r\n  \r\nexport default function ConsultationContainer({teleconsultation, socket}) {\r\n\r\n    const [addRapport, setAddRapport] = useState(false)\r\n    const [fieldValidationErrors, setFieldValidationErrors] = useState({})\r\n    const [state, setState] = useState({isCompleted: false})\r\n    const [response, setResponse] = useState({\r\n        sending:false,\r\n        success:false,   \r\n        donneIncorecte: false                 \r\n    })\r\n    const router = useRouter();\r\n    const {locale} = router;\r\n    const content = locale === \"ar\" ? contentAR : locale === \"en\" ? contentEN : contentFR;\r\n    const { userData } = useAuth();\r\n\r\n\r\n\r\n    const handleSubmit = (e) => {\r\n        e.preventDefault();\r\n        setResponse(old =>  { return {...old, sending: true}});\r\n\r\n        let data = state;\r\n\r\n        fetch(`${Config.BACKEND_URL}/feedback`,{\r\n            method:\"post\",\r\n            headers: {\r\n                'Content-Type': 'application/json',\r\n                'Authorization': `token ${userData.token}`,\r\n            },\r\n            body:JSON.stringify({...data, consultationId: teleconsultation.id })\r\n        })\r\n        .then(\r\n            (r) => r.json()\r\n            .then(res => {\r\n\r\n                if(!res.error){\r\n                    // props.setUserData(res);\r\n                    setResponse({sending: false, success:true, donneIncorecte: false});\r\n                    \r\n                    \r\n                }else {\r\n                    setResponse({sending: false, success:false, donneIncorecte:true})\r\n                    if(res.validator){\r\n\r\n                    }else{\r\n\r\n                    }\r\n                }\r\n           \r\n            })\r\n            ).catch(error =>{ \r\n                console.log(error)\r\n                setResponse({sending: false, success:false, donneIncorecte:true})\r\n            })\r\n    }\r\n\r\n    \r\n\r\n    const validateField = () => {\r\n\r\n    }\r\n\r\n    const handleChange = ({target : {value, name}}) => {\r\n\r\n        if(name===\"isCompleted\"){\r\n            setState(old => {return { ...old, isCompleted: !state.isCompleted}}) ;\r\n        }else {\r\n            setState(old => {return { ...old, [name]: value}}) ;\r\n        }\r\n\r\n    }\r\n       \r\n    return (\r\n        <div className=\"teleconsultation\">\r\n            <Row className=\"m-0\">\r\n               <Col lg=\"6\" md={12} sm={12} xs={12}>\r\n                    <ChatContainer teleconsultation = {teleconsultation} socket={socket}  />\r\n               </Col>\r\n               <Col lg=\"6\" md={12} sm={12} xs={12}>\r\n                    <Card>\r\n                        <CardBody>\r\n                        \r\n                            <div>  \r\n                                <strong> Document Ã  partager dans cette consultation </strong>\r\n                                <DocumentC documents={teleconsultation? teleconsultation.documents:[]} socket={socket} consultation={teleconsultation} />\r\n                            </div>\r\n                               \r\n                        </CardBody>\r\n                    </Card>\r\n                    <Card>\r\n                        <CardBody>\r\n                        \r\n                            <div>  \r\n                            <strong> Ajouter un rapport  </strong>\r\n                            {\r\n                                addRapport ? \r\n                                <div> \r\n                                    <form onSubmit={handleSubmit} autoComplete=\"off\">\r\n            \r\n                                        <Row>\r\n                                                <Col xs=\"12\" md=\"6\" className=\"mt-3\"> \r\n                                                    <TextField\r\n                                                        error={fieldValidationErrors.nomError}\r\n                                                        placeholder=\"\"\r\n                                                        label={content.report.labelNom}\r\n                                                        required={false}\r\n                                                        variant=\"outlined\"\r\n                                                        name=\"type\"\r\n                                                        onBlur={validateField} \r\n                                                        value={state.nom}\r\n                                                        onChange={handleChange} \r\n                                                    />\r\n                                                </Col>\r\n                                                <Col xs=\"12\" md=\"12\" className=\"mt-3\" > \r\n                                                    <TextField\r\n                                                        placeholder=\"\"\r\n                                                        variant=\"outlined\"\r\n                                                        required={false}\r\n                                                        error={fieldValidationErrors.prenomError}\r\n                                                        label={content.report.labelPrenom}\r\n                                                        onBlur={validateField} \r\n                                                        name=\"description\"\r\n                                                        fullWidth\r\n                                                        value={state.description}\r\n                                                        onChange={handleChange} \r\n                                                    />\r\n                                                \r\n                                                </Col>\r\n                                                <Col xs=\"12\" md=\"6\" className=\"mt-3\" > \r\n                                                    <Checkbox\r\n                                                        placeholder=\"\"\r\n                                                        variant=\"outlined\"\r\n                                                        required={false}\r\n                                                        error={fieldValidationErrors.prenomError}\r\n                                                        label={content.report.labelEnd}\r\n                                                        name=\"isCompleted\"\r\n                                                        checked={state.isCompleted}\r\n                                                        rtl={locale === \"ar\"?  true : false}\r\n                                                        onChange={handleChange} \r\n                                                    />\r\n                                                </Col>\r\n                                        </Row>\r\n                                        <Row className=\"justify-content-center\">\r\n                                            <Collapse in={response.donneIncorecte}>\r\n                                                <div className=\"mt-5\">\r\n                                                    <Alert  variant=\"danger\">\r\n                                                        {content.report.errorSignup}\r\n                                                    </Alert>\r\n                                                </div>\r\n                                            </Collapse>\r\n                                        </Row>\r\n                                        <Row className=\"justify-content-center\">\r\n                                            <Collapse in={response.success}>\r\n                                                <div className=\"mt-5\">\r\n                                                    <Alert  variant=\"success\">\r\n                                                        {content.report.successSignup}\r\n                                                    </Alert>\r\n                                                </div>\r\n                                            </Collapse>\r\n                                        </Row>\r\n                                        <Row className=\"align-items-center justify-content-around mt-4 \">\r\n                                            <Button type=\"submit\" color=\"primary\"> {content.report.signup} </Button>\r\n                                        </Row>\r\n                                    </form>\r\n                                </div>\r\n                                : \r\n                                <div>\r\n                                    <Button color=\"primary\" onClick={() => setAddRapport(true)}> Ajouter rapport </Button>\r\n                                </div>\r\n                            }\r\n                            </div>\r\n                               \r\n                        </CardBody>\r\n                    </Card>\r\n                </Col>\r\n            </Row>\r\n        </div>\r\n    )\r\n}\r\n\r\nfunction ChatContainer(props) {\r\n    const [onConsuting, setonConsuting] = useState(false);\r\n    const [onCalling, setonCalling] = useState(false);\r\n    const [difference, setdifference] = useState(0);\r\n    const [now, setnow] = useState(0);\r\n\r\n    \r\n    useEffect(()=>{\r\n    if(props.socket){\r\n        props.socket.on(\"call-entring\", () => {\r\n            setonCalling(true);\r\n        });\r\n\r\n        props.socket.emit('check-time', {consultationId: props.teleconsultation.id}, (response)=> { \r\n            setdifference(response.diff);\r\n            setnow(response.now)\r\n            setonConsuting(response.isTime);\r\n        });  \r\n    }\r\n      \r\n    }, [props.socket])\r\n\r\n    return (\r\n        <div>\r\n            {\r\n                props.teleconsultation?\r\n                <Row className=\"justify-content-around m-0\">\r\n                    <Col lg=\"12\" className = \"bg-white p-0 discussion-container\">\r\n                        <Row className=\"m-0\">\r\n                            <InfoBar\r\n                                onConsuting={onConsuting} \r\n                                medecin={props.teleconsultation.medecin} \r\n                                teleconsultation={props.teleconsultation}\r\n                            />\r\n                        </Row>\r\n                    \r\n                        <Row className=\"discussion m-0\">\r\n                            <ProcessZone \r\n                            onConsuting={onConsuting} \r\n                            medecin={props.teleconsultation.medecin}\r\n                            difference={difference}\r\n                            now={now}\r\n                            setonCalling={setonCalling}\r\n                            onCalling={onCalling}\r\n                            {...props}\r\n                             />\r\n                        </Row>\r\n                    </Col>\r\n                </Row> \r\n                : null\r\n            }\r\n            \r\n        </div>\r\n    )\r\n}\r\nfunction ProcessZone(props){\r\n    \r\n    useEffect(() => {\r\n        if(navigator){\r\n            if(navigator.permissions){\r\n                navigator.permissions.query({name: \"camera\"})\r\n                .then((res) => console.log(res),\r\n                    e => console.log(e.name +\": \"+ e.message))\r\n                .catch(err => {\r\n                    console.log(e.name +\": \"+ e.message)\r\n                })\r\n        \r\n              navigator.permissions.query({name: \"microphone\"})\r\n              .then(({state}) => console.log(state),\r\n            e => console.log(e.name +\": \"+ e.message));\r\n          \r\n                // navigator.mediaDevices.enumerateDevices()\r\n                // .then(devices => {\r\n                //     const filtered = devices.filter(device => device.kind === 'videoinput');\r\n                //     // console.log('Cameras found', filtered)\r\n                //     // callback(filtered);\r\n                // })\r\n                // .catch(err=> {\r\n                //     console.log(`Unable to fetsh stream ${err}`)\r\n                // })\r\n            }\r\n          \r\n        }\r\n       \r\n        return () => {\r\n            \r\n        }\r\n    }, [])\r\n    if(props.onCalling) {\r\n        return(\r\n            <VideoCall {...props} />\r\n        )\r\n    }\r\n\r\n    if(props.onConsuting) {\r\n        return(\r\n            <Chat {...props} />\r\n        )\r\n    }\r\n    switch (true) {\r\n        case props.difference > 0:\r\n            return (\r\n                <FutureConsultation difference={props.difference}now={props.now} />\r\n            )\r\n        case props.difference < 0:\r\n            return (\r\n                <OldConsultation />\r\n            )\r\n        default:\r\n            return(\r\n                <div>\r\n                    <p> Nous avons pas pus dÃ©duire le crÃ©neau de cette consultation. Veillez rafrÃ©chir la page pour rÃ©ssayer </p>\r\n                </div>\r\n            )\r\n    }\r\n   \r\n}\r\n\r\n\r\n  \r\n\r\nfunction Chat(props) {\r\n    const [messages, setMessages] = useState([]);\r\n    const [message, setMessage] = useState(\"\");\r\n    \r\n    const sendMessage = (event) => {\r\n        event.preventDefault();\r\n        if(message) {\r\n          setMessage('')\r\n          let data = {message: message, type:\"text\", sentBy:\"patient\", sentTo: \"medecin\", selectedUser: \"m\" + props.medecin.id, consultationId: props.teleconsultation.id };\r\n          setMessages(messages => [ ...messages, {isSentByCurrentUser: true,  data} ]);\r\n           props.socket.emit('sendMessage', data, ()=> { });    \r\n        }\r\n    }\r\n\r\n    useEffect(()=>{\r\n        if(props.socket){\r\n            props.socket.on('message', (message) => {\r\n                setMessages(messages => [ ...messages, message ]);\r\n            });\r\n        \r\n\r\n        }\r\n        return () => {\r\n            if(props.socket){\r\n                props.socket.removeAllListeners('message')\r\n            }\r\n            \r\n        }\r\n    }, [props.socket])\r\n\r\n    return(\r\n        <Col lg=\"12\" md=\"12\" sm=\"12\" xs=\"12\" className=\"chat-messages p-0\">\r\n            <Messages messages={messages} user={props.medecin} storedMessages={props.teleconsultation.messages} />\r\n            <SendMessageForm message={message} setMessage={setMessage} sendMessage={sendMessage} active={props.teleconsultation.active} />\r\n        </Col>\r\n    )\r\n}\r\n\r\nfunction FutureConsultation({difference,now}) {\r\n\r\n    return(\r\n        <Col lg=\"12\" md=\"12\" sm=\"12\" xs=\"12\" className=\"chat-messages p-5\">\r\n            <Row className=\"justify-content-center align-items-center h-100\">\r\n                <CountDown \r\n                    difference={difference} \r\n                    now={now}\r\n                />\r\n            </Row>\r\n        </Col>\r\n    )\r\n}\r\n\r\nfunction OldConsultation(props) {\r\n   \r\n\r\n    return(\r\n        <Col lg=\"12\" md=\"12\" sm=\"12\" xs=\"12\" className=\"chat-messages p-0\">\r\n            <Row className=\"justify-content-center align-items-center h-100\">\r\n                <div>\r\n                <h2> consultation passer </h2>\r\n                </div>\r\n            </Row>\r\n        </Col>\r\n    )\r\n}\r\n"]},"metadata":{},"sourceType":"module"}