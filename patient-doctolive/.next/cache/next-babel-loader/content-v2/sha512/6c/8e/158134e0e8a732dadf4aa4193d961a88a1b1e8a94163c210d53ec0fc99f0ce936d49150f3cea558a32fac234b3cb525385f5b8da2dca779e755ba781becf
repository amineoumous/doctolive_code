{"ast":null,"code":"import { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport React, { useState, useEffect } from 'react';\nimport Config from './../../EndPoint';\nimport { TiDeleteOutline } from 'react-icons/ti';\nimport { Row, Col, Container, Alert } from 'react-bootstrap';\nimport { useAuth } from './../../context/AuthContext';\nimport ReactFancyBox from './../../components/fancyBox/fancybox/ReactFancyBox';\nimport { useRouter } from 'next/router';\nimport contentFR from './../../contentFR';\nimport contentEN from './../../contentEN';\nimport contentAR from './../../contentAR';\nexport default function Documents() {\n  const router = useRouter();\n  const {\n    locale\n  } = router;\n  const {\n    userData\n  } = useAuth();\n  const content = locale === \"ar\" ? contentAR : locale === \"en\" ? contentEN : contentFR;\n  const {\n    0: savedPictures,\n    1: setSavedPictures\n  } = useState([]);\n\n  const deleteImageHandle = async file => {\n    let response = await fetch(`${Config.BACKEND_URL}/upload/document`, {\n      method: 'DELETE',\n      body: JSON.stringify({\n        path: file.path,\n        id: file.id\n      }),\n      headers: {\n        'Accept': 'application/json',\n        'Content-Type': 'application/json',\n        'Authorization': `token ${userData.token}`\n      }\n    });\n    response.json().then(response => {\n      let index = savedPictures.findIndex(fl => fl.id === file.id);\n      setSavedPictures(oldFiles => {\n        let clone = [...oldFiles];\n        clone.splice(index, 1);\n        return clone;\n      });\n    }).catch(error => {});\n  };\n\n  useEffect(async () => {\n    if (!userData.token) return router.push('account/new');\n    const res = await fetch(`${Config.BACKEND_URL}/patient/documents`, {\n      headers: {\n        'Accept': 'application/json',\n        'Content-Type': 'application/json',\n        'Authorization': `token ${userData.token}`\n      }\n    });\n    const data = await res.json();\n    setSavedPictures(data.documents);\n    return () => {};\n  }, []);\n\n  if (!savedPictures) {\n    return /*#__PURE__*/_jsx(Container, {\n      children: /*#__PURE__*/_jsxs(\"h3\", {\n        children: [\" \", content.documents.aucun, \" \"]\n      })\n    });\n  }\n\n  if (!savedPictures.length) {\n    return /*#__PURE__*/_jsx(Container, {\n      children: /*#__PURE__*/_jsxs(\"h3\", {\n        children: [\" \", content.documents.aucun, \" \"]\n      })\n    });\n  }\n\n  return /*#__PURE__*/_jsx(Container, {\n    children: /*#__PURE__*/_jsx(Row, {\n      className: \"align-items-center justify-content-around mt-4 \",\n      children: savedPictures.length > 0 ? /*#__PURE__*/_jsx(Row, {\n        className: \"images-saved\",\n        children: savedPictures.map((file, index) => {\n          return /*#__PURE__*/_jsx(Col, {\n            className: \"mt-5 p-5\",\n            lg: \"4\",\n            md: \"4\",\n            xs: \"6\",\n            children: /*#__PURE__*/_jsxs(\"div\", {\n              className: \"image-saved\",\n              children: [file.type === \"application/pdf\" ? /*#__PURE__*/_jsxs(\"a\", {\n                href: Config.BACKEND_URL + file.path,\n                download: file.name,\n                target: \"_blank\",\n                rel: \"noopener noreferrer\",\n                children: [\"  \", /*#__PURE__*/_jsx(\"img\", {\n                  src: \"/image/pdf.png\",\n                  alt: \"...\",\n                  className: \"img-fluid\"\n                }), \" \"]\n              }) : /*#__PURE__*/_jsx(ReactFancyBox, {\n                thumbnail: `${Config.BACKEND_URL}${file.path}`,\n                showCloseBtn: false,\n                image: `${Config.BACKEND_URL}${file.path}`\n              }), /*#__PURE__*/_jsxs(\"p\", {\n                children: [\" \", file.sentTo === \"patient\" ? /*#__PURE__*/_jsxs(\"label\", {\n                  children: [content.documents.sharedBy, \" \"]\n                }) : /*#__PURE__*/_jsxs(\"label\", {\n                  children: [\" \", content.documents.sharedBy, \" \"]\n                }), /*#__PURE__*/_jsxs(\"strong\", {\n                  children: [\" Dr. \", file.medecin.nom + \"  \" + file.medecin.prenom, \" \"]\n                }), \" \"]\n              }), /*#__PURE__*/_jsxs(\"span\", {\n                onClick: () => deleteImageHandle(file),\n                className: \"delete-button\",\n                children: [\" \", /*#__PURE__*/_jsx(TiDeleteOutline, {}), \" \"]\n              })]\n            })\n          }, index);\n        })\n      }) : null\n    })\n  });\n}","map":null,"metadata":{},"sourceType":"module"}