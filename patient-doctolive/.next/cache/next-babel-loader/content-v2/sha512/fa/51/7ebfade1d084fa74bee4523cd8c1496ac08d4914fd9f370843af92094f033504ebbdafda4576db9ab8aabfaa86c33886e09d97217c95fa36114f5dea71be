{"ast":null,"code":"import _regeneratorRuntime from \"C:/app/doctolive_code/patient-doctolive/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"C:/app/doctolive_code/patient-doctolive/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"C:\\\\app\\\\doctolive_code\\\\patient-doctolive\\\\components\\\\MedecinWidget\\\\CalendarAvailability.js\",\n    _s = $RefreshSig$();\n\nimport { useState, useEffect } from 'react';\nimport moment from 'moment';\nimport { MdChevronLeft, MdChevronRight } from 'react-icons/md';\nimport { Divider } from '@material-ui/core';\nimport Config from './../../EndPoint';\nimport { useAuth } from './../../context/AuthContext';\nexport default function CalendarAvailability(props) {\n  _s();\n\n  var _this = this;\n\n  var _useState = useState(moment()),\n      startDate = _useState[0],\n      setStartDate = _useState[1];\n\n  var _useState2 = useState([]),\n      calandar = _useState2[0],\n      setMedecinCalendar = _useState2[1];\n\n  var _useState3 = useState(false),\n      showall = _useState3[0],\n      setShowall = _useState3[1];\n\n  var _useAuth = useAuth(),\n      userData = _useAuth.userData;\n\n  var selectHour = function selectHour(day, hour, disable) {\n    console.log(hour);\n\n    if (disable) {//    this.setState({ error: true, expired:true, message: 'ce moment est indisponible' })\n      //    setTimeout(() => {\n      //        this.setState({expired: false})\n      //    }, 5000);\n    } else {\n      props.setSelectedHour(day.format('YYYY/MM/DD'), hour);\n    }\n  };\n\n  var changeDate = function changeDate(direction) {\n    if (direction === 'next') {\n      setStartDate(moment(startDate).add(7, 'days'));\n    } else {\n      if (moment(startDate).isAfter(moment())) {\n        setStartDate(moment(startDate).subtract(7, 'days')); //    this.setState({ startDate: moment(this.state.startDate).subtract(7, 'days') })\n      }\n    }\n  };\n\n  var createHoursSoir = function createHoursSoir(day) {\n    var _props$medecin;\n\n    var disponibiliteDay = (_props$medecin = props.medecin) === null || _props$medecin === void 0 ? void 0 : _props$medecin.horaires.find(function (h) {\n      return h.jour === day.format('dddd');\n    });\n    if (!disponibiliteDay) return [];\n    var table = [];\n    var endHour = moment(disponibiliteDay.fin_soir, 'HH:mm:ss');\n    var hour = moment(disponibiliteDay.debut_soir, 'HH:mm:ss');\n    var i = 0;\n    var k = 5;\n\n    if (showall) {\n      k = 100;\n    }\n\n    var _loop = function _loop() {\n      var element = undefined;\n\n      if (calandar) {\n        // element = calandar.find( e => moment.utc(e.date).format('HH:mm') === hour)\n        element = calandar.find(function (e) {\n          // return moment(e.date).isSame(day.format('YYYY-MM-DDT') + hour.format('HH:mm')+\":00.000Z\", \"minutes\")\n          return e.time === hour.format('HH:mm:ss') && day.format('YYYY-MM-DD') === e.date;\n        });\n      }\n\n      var HourInTheDay = moment(moment(day).format('YYYY/MM/DD') + hour.format('HH:mm'), 'YYYY/MM/DDHH:mm');\n      var isDisabled = element !== undefined || moment().isAfter(HourInTheDay);\n      var cloneHour = hour.format('HH:mm');\n      var hourDiv = !isDisabled ? /*#__PURE__*/_jsxDEV(\"div\", {\n        disabled: isDisabled,\n        className: isDisabled ? \"cell hours-element disabled\" : \"cell hours-element\",\n        onClick: function onClick() {\n          return selectHour(day, cloneHour, isDisabled);\n        },\n        children: /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"hour\",\n          children: [\" \", hour.format('HH:mm'), \" \"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 79,\n          columnNumber: 21\n        }, _this)\n      }, i, false, {\n        fileName: _jsxFileName,\n        lineNumber: 73,\n        columnNumber: 42\n      }, _this) : /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \" hours-element-disabled\",\n        children: [\" \", /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"hour-empty\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"-:-\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 81,\n            columnNumber: 99\n          }, _this), \"   \"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 81,\n          columnNumber: 71\n        }, _this), \" \"]\n      }, i, true, {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 19\n      }, _this);\n      table.push(hourDiv);\n      i++;\n      hour = hour.add(disponibiliteDay.duree, 'minutes');\n    };\n\n    while (hour.isBefore(endHour) && i < k) {\n      _loop();\n    }\n\n    return table;\n  };\n\n  var createHoursMatin = function createHoursMatin(day) {\n    var _props$medecin2;\n\n    var disponibiliteDay = (_props$medecin2 = props.medecin) === null || _props$medecin2 === void 0 ? void 0 : _props$medecin2.horaires.find(function (h) {\n      return h.jour === day.lang(\"fr\").format('dddd');\n    });\n    if (!disponibiliteDay) return [];\n    var table = [];\n    var endHour = moment(disponibiliteDay.fin_matin, 'HH:mm:ss');\n    var hour = moment(disponibiliteDay.debut_matin, 'HH:mm:ss');\n    var i = 0;\n    var k = 5;\n\n    if (showall) {\n      k = 100;\n    }\n\n    var _loop2 = function _loop2() {\n      var element = undefined;\n\n      if (calandar) {\n        element = calandar.find(function (e) {\n          return e.time === hour.format('HH:mm:ss') && day.format('YYYY-MM-DD') === e.date;\n        });\n      }\n\n      var HourInTheDay = moment(moment(day).format('YYYY/MM/DD') + hour, 'YYYY/MM/DDHH:mm');\n      var cloneHour = hour.format('HH:mm');\n      var isDisabled = element !== undefined || moment().isAfter(HourInTheDay);\n      var hourDiv = !isDisabled ? /*#__PURE__*/_jsxDEV(\"div\", {\n        disabled: isDisabled,\n        className: isDisabled ? \"cell hours-element disabled\" : \"cell hours-element\",\n        onClick: function onClick() {\n          return selectHour(day, cloneHour, isDisabled);\n        },\n        children: /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"hour\",\n          children: [hour.format('HH:mm'), \"  \"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 126,\n          columnNumber: 21\n        }, _this)\n      }, i, false, {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 42\n      }, _this) : /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \" hours-element-disabled\",\n        children: [\" \", /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"hour-empty\",\n          children: /*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"-:-\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 128,\n            columnNumber: 98\n          }, _this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 128,\n          columnNumber: 70\n        }, _this), \" \"]\n      }, i, true, {\n        fileName: _jsxFileName,\n        lineNumber: 128,\n        columnNumber: 19\n      }, _this);\n      table.push(hourDiv);\n      i++;\n      hour = hour.add(disponibiliteDay.duree, 'minutes');\n    };\n\n    while (hour.isBefore(endHour) && i < k) {\n      _loop2();\n    }\n\n    return table;\n  };\n\n  useEffect( /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n    var _props$medecin3;\n\n    var res, data;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.next = 2;\n            return fetch(\"\".concat(Config.BACKEND_URL, \"/consultation/medecin-calendar/\").concat((_props$medecin3 = props.medecin) === null || _props$medecin3 === void 0 ? void 0 : _props$medecin3.id, \"/\").concat(startDate), {\n              headers: {\n                'Accept': 'application/json',\n                'Content-Type': 'application/json',\n                'Authorization': \"token \".concat(userData.token)\n              }\n            });\n\n          case 2:\n            res = _context.sent;\n            _context.next = 5;\n            return res.json();\n\n          case 5:\n            data = _context.sent;\n            setMedecinCalendar(data.medecinCalendar);\n\n          case 7:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  })), [startDate]);\n\n  var createCalendar = function createCalendar() {\n    var table = [];\n\n    for (var i = 0; i <= 6; i++) {\n      var date = moment(startDate).add(i, 'days');\n\n      var dayAvailability = /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"calendar-day\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"calendar-day-title\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"cell-content\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"calendar-day-name\",\n              children: [date.format('dddd'), \" \"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 159,\n              columnNumber: 29\n            }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"calendar-day-date\",\n              children: date.format('D') + \" \" + date.format(\"MMM\")\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 160,\n              columnNumber: 29\n            }, _this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 158,\n            columnNumber: 25\n          }, _this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 157,\n          columnNumber: 21\n        }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [createHoursMatin(date), /*#__PURE__*/_jsxDEV(Divider, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 165,\n            columnNumber: 25\n          }, _this), createHoursSoir(date)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 163,\n          columnNumber: 21\n        }, _this)]\n      }, i, true, {\n        fileName: _jsxFileName,\n        lineNumber: 156,\n        columnNumber: 39\n      }, _this);\n\n      table.push(dayAvailability);\n    }\n\n    return table;\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"section\", {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"date-range-calendar\",\n      style: props.locale === \"ar\" ? {\n        direction: \"rtl\",\n        textAlign: \"right\"\n      } : {\n        direction: \"ltr\"\n      },\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"range-calendar\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"calendar-pagination\",\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"\",\n            id: \"date-range-preview\",\n            onClick: function onClick() {\n              return changeDate('preview');\n            },\n            children: [\"  \", props.locale === \"ar\" ? /*#__PURE__*/_jsxDEV(MdChevronRight, {\n              color: \"#1AB9B9\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 181,\n              columnNumber: 137\n            }, this) : /*#__PURE__*/_jsxDEV(MdChevronLeft, {\n              color: \"#1AB9B9\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 181,\n              columnNumber: 172\n            }, this), \"  \"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 181,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 180,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"calendar\",\n          children: props.medecin ? createCalendar() : null\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 183,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"calendar-pagination\",\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"\",\n            id: \"date-range-next\",\n            onClick: function onClick() {\n              return changeDate('next');\n            },\n            children: [\"  \", props.locale === \"ar\" ? /*#__PURE__*/_jsxDEV(MdChevronLeft, {\n              color: \"#1AB9B9\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 187,\n              columnNumber: 131\n            }, this) : /*#__PURE__*/_jsxDEV(MdChevronRight, {\n              color: \"#1AB9B9\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 187,\n              columnNumber: 167\n            }, this), \" \"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 187,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 186,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 179,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 177,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"text-center w-100\",\n      children: /*#__PURE__*/_jsxDEV(\"a\", {\n        href: \"\",\n        className: \"show-all\",\n        onClick: function onClick() {\n          return setShowall(true);\n        },\n        children: \"VOIRE PLUS D\\u2019HORAIRES\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 192,\n        columnNumber: 13\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 191,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 176,\n    columnNumber: 9\n  }, this);\n}\n\n_s(CalendarAvailability, \"5j8A8NlKtQoU+c4srRAV89zBimM=\", false, function () {\n  return [useAuth];\n});\n\n_c = CalendarAvailability;\n\nvar _c;\n\n$RefreshReg$(_c, \"CalendarAvailability\");","map":{"version":3,"sources":["C:/app/doctolive_code/patient-doctolive/components/MedecinWidget/CalendarAvailability.js"],"names":["useState","useEffect","moment","MdChevronLeft","MdChevronRight","Divider","Config","useAuth","CalendarAvailability","props","startDate","setStartDate","calandar","setMedecinCalendar","showall","setShowall","userData","selectHour","day","hour","disable","console","log","setSelectedHour","format","changeDate","direction","add","isAfter","subtract","createHoursSoir","disponibiliteDay","medecin","horaires","find","h","jour","table","endHour","fin_soir","debut_soir","i","k","element","undefined","e","time","date","HourInTheDay","isDisabled","cloneHour","hourDiv","push","duree","isBefore","createHoursMatin","lang","fin_matin","debut_matin","fetch","BACKEND_URL","id","headers","token","res","json","data","medecinCalendar","createCalendar","dayAvailability","locale","textAlign"],"mappings":";;;;;;;AACA,SAAQA,QAAR,EAAkBC,SAAlB,QAAkC,OAAlC;AAEA,OAAOC,MAAP,MAAmB,QAAnB;AACA,SAASC,aAAT,EAAwBC,cAAxB,QAA6C,gBAA7C;AACA,SAASC,OAAT,QAAwB,mBAAxB;AAEA,OAAOC,MAAP,MAAmB,kBAAnB;AACA,SAASC,OAAT,QAAwB,6BAAxB;AAEA,eAAe,SAASC,oBAAT,CAA8BC,KAA9B,EAAqC;AAAA;;AAAA;;AAAA,kBACdT,QAAQ,CAACE,MAAM,EAAP,CADM;AAAA,MACzCQ,SADyC;AAAA,MAC9BC,YAD8B;;AAAA,mBAETX,QAAQ,CAAC,EAAD,CAFC;AAAA,MAEzCY,QAFyC;AAAA,MAE/BC,kBAF+B;;AAAA,mBAGlBb,QAAQ,CAAC,KAAD,CAHU;AAAA,MAGzCc,OAHyC;AAAA,MAGhCC,UAHgC;;AAAA,iBAK7BR,OAAO,EALsB;AAAA,MAKzCS,QALyC,YAKzCA,QALyC;;AAOhD,MAAMC,UAAU,GAAG,SAAbA,UAAa,CAACC,GAAD,EAAMC,IAAN,EAAYC,OAAZ,EAAwB;AACvCC,IAAAA,OAAO,CAACC,GAAR,CAAYH,IAAZ;;AACA,QAAGC,OAAH,EAAW,CACX;AACA;AACA;AACA;AACC,KALD,MAKK;AACDX,MAAAA,KAAK,CAACc,eAAN,CAAsBL,GAAG,CAACM,MAAJ,CAAW,YAAX,CAAtB,EAAgDL,IAAhD;AACH;AACJ,GAVD;;AAaA,MAAMM,UAAU,GAAG,SAAbA,UAAa,CAACC,SAAD,EAAe;AAE9B,QAAIA,SAAS,KAAK,MAAlB,EAAyB;AACrBf,MAAAA,YAAY,CAAET,MAAM,CAACQ,SAAD,CAAN,CAAkBiB,GAAlB,CAAsB,CAAtB,EAAyB,MAAzB,CAAF,CAAZ;AACH,KAFD,MAEK;AACD,UAAIzB,MAAM,CAACQ,SAAD,CAAN,CAAkBkB,OAAlB,CAA0B1B,MAAM,EAAhC,CAAJ,EAAwC;AACpCS,QAAAA,YAAY,CAAET,MAAM,CAACQ,SAAD,CAAN,CAAkBmB,QAAlB,CAA2B,CAA3B,EAA8B,MAA9B,CAAF,CAAZ,CADoC,CAExC;AACA;AACH;AACJ,GAVD;;AAYA,MAAMC,eAAe,GAAG,SAAlBA,eAAkB,CAACZ,GAAD,EAAS;AAAA;;AAC7B,QAAMa,gBAAgB,qBAAGtB,KAAK,CAACuB,OAAT,mDAAG,eAAeC,QAAf,CAAwBC,IAAxB,CAA6B,UAAAC,CAAC;AAAA,aAAIA,CAAC,CAACC,IAAF,KAAWlB,GAAG,CAACM,MAAJ,CAAW,MAAX,CAAf;AAAA,KAA9B,CAAzB;AAEA,QAAG,CAACO,gBAAJ,EAAsB,OAAO,EAAP;AAEtB,QAAIM,KAAK,GAAG,EAAZ;AACA,QAAIC,OAAO,GAAGpC,MAAM,CAAC6B,gBAAgB,CAACQ,QAAlB,EAA4B,UAA5B,CAApB;AACA,QAAIpB,IAAI,GAAGjB,MAAM,CAAC6B,gBAAgB,CAACS,UAAlB,EAA8B,UAA9B,CAAjB;AAEA,QAAIC,CAAC,GAAC,CAAN;AACA,QAAIC,CAAC,GAAC,CAAN;;AACA,QAAG5B,OAAH,EAAW;AACP4B,MAAAA,CAAC,GAAC,GAAF;AACH;;AAb4B;AAiBzB,UAAIC,OAAO,GAAEC,SAAb;;AAEA,UAAGhC,QAAH,EAAY;AACR;AACA+B,QAAAA,OAAO,GAAG/B,QAAQ,CAACsB,IAAT,CAAe,UAAAW,CAAC,EAAI;AAC1B;AACA,iBAAOA,CAAC,CAACC,IAAF,KAAW3B,IAAI,CAACK,MAAL,CAAY,UAAZ,CAAX,IAAsCN,GAAG,CAACM,MAAJ,CAAW,YAAX,MAA6BqB,CAAC,CAACE,IAA5E;AACH,SAHS,CAAV;AAIH;;AACD,UAAIC,YAAY,GAAG9C,MAAM,CAAEA,MAAM,CAACgB,GAAD,CAAN,CAAYM,MAAZ,CAAmB,YAAnB,IAAmCL,IAAI,CAACK,MAAL,CAAY,OAAZ,CAArC,EAA2D,iBAA3D,CAAzB;AACA,UAAIyB,UAAU,GAAIN,OAAO,KAAKC,SAAb,IAA4B1C,MAAM,GAAG0B,OAAT,CAAiBoB,YAAjB,CAA7C;AAEA,UAAIE,SAAS,GAAG/B,IAAI,CAACK,MAAL,CAAY,OAAZ,CAAhB;AACA,UAAI2B,OAAO,GAAG,CAACF,UAAD,gBAAe;AACzB,QAAA,QAAQ,EAAEA,UADe;AAGzB,QAAA,SAAS,EAAEA,UAAU,GAAG,6BAAH,GAAmC,oBAH/B;AAIzB,QAAA,OAAO,EAAG;AAAA,iBAAMhC,UAAU,CAACC,GAAD,EAAMgC,SAAN,EAAiBD,UAAjB,CAAhB;AAAA,SAJe;AAAA,+BAMrB;AAAM,UAAA,SAAS,EAAC,MAAhB;AAAA,0BAAyB9B,IAAI,CAACK,MAAL,CAAY,OAAZ,CAAzB;AAAA;AAAA;AAAA;AAAA;AAAA;AANqB,SAEpBiB,CAFoB;AAAA;AAAA;AAAA;AAAA,eAAf,gBAQR;AAAc,QAAA,SAAS,EAAC,yBAAxB;AAAA,qCAAoD;AAAK,UAAA,SAAS,EAAC,YAAf;AAAA,kCAA4B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAA5B;AAAA;AAAA;AAAA;AAAA;AAAA,iBAApD;AAAA,SAAUA,CAAV;AAAA;AAAA;AAAA;AAAA,eARN;AASAJ,MAAAA,KAAK,CAACe,IAAN,CAAWD,OAAX;AACAV,MAAAA,CAAC;AACDtB,MAAAA,IAAI,GAAGA,IAAI,CAACQ,GAAL,CAASI,gBAAgB,CAACsB,KAA1B,EAAiC,SAAjC,CAAP;AAzCyB;;AAc5B,WAAOlC,IAAI,CAACmC,QAAL,CAAchB,OAAd,KAA0BG,CAAC,GAAEC,CAApC,EAAuC;AAAA;AA4BvC;;AAED,WAAOL,KAAP;AACH,GA7CD;;AAiDA,MAAMkB,gBAAgB,GAAG,SAAnBA,gBAAmB,CAACrC,GAAD,EAAS;AAAA;;AAC9B,QAAMa,gBAAgB,sBAAGtB,KAAK,CAACuB,OAAT,oDAAG,gBAAeC,QAAf,CAAwBC,IAAxB,CAA6B,UAAAC,CAAC;AAAA,aAAIA,CAAC,CAACC,IAAF,KAAWlB,GAAG,CAACsC,IAAJ,CAAS,IAAT,EAAehC,MAAf,CAAsB,MAAtB,CAAf;AAAA,KAA9B,CAAzB;AAEA,QAAG,CAACO,gBAAJ,EAAsB,OAAO,EAAP;AAEtB,QAAIM,KAAK,GAAG,EAAZ;AACA,QAAIC,OAAO,GAAGpC,MAAM,CAAC6B,gBAAgB,CAAC0B,SAAlB,EAA6B,UAA7B,CAApB;AACA,QAAItC,IAAI,GAAGjB,MAAM,CAAC6B,gBAAgB,CAAC2B,WAAlB,EAA+B,UAA/B,CAAjB;AAEA,QAAIjB,CAAC,GAAC,CAAN;AACA,QAAIC,CAAC,GAAC,CAAN;;AACA,QAAG5B,OAAH,EAAW;AACP4B,MAAAA,CAAC,GAAC,GAAF;AACH;;AAb6B;AAe1B,UAAIC,OAAO,GAAEC,SAAb;;AAEA,UAAGhC,QAAH,EAAY;AACR+B,QAAAA,OAAO,GAAG/B,QAAQ,CAACsB,IAAT,CAAe,UAAAW,CAAC,EAAI;AAC1B,iBAAOA,CAAC,CAACC,IAAF,KAAW3B,IAAI,CAACK,MAAL,CAAY,UAAZ,CAAX,IAAsCN,GAAG,CAACM,MAAJ,CAAW,YAAX,MAA6BqB,CAAC,CAACE,IAA5E;AAEH,SAHS,CAAV;AAIH;;AAED,UAAIC,YAAY,GAAG9C,MAAM,CAAEA,MAAM,CAACgB,GAAD,CAAN,CAAYM,MAAZ,CAAmB,YAAnB,IAAmCL,IAArC,EAA2C,iBAA3C,CAAzB;AACA,UAAI+B,SAAS,GAAG/B,IAAI,CAACK,MAAL,CAAY,OAAZ,CAAhB;AAEA,UAAIyB,UAAU,GAAIN,OAAO,KAAKC,SAAb,IAA4B1C,MAAM,GAAG0B,OAAT,CAAiBoB,YAAjB,CAA7C;AACA,UAAIG,OAAO,GAAG,CAACF,UAAD,gBAAe;AACzB,QAAA,QAAQ,EAAEA,UADe;AAGzB,QAAA,SAAS,EAAEA,UAAU,GAAG,6BAAH,GAAmC,oBAH/B;AAIzB,QAAA,OAAO,EAAG;AAAA,iBAAMhC,UAAU,CAACC,GAAD,EAAMgC,SAAN,EAAiBD,UAAjB,CAAhB;AAAA,SAJe;AAAA,+BAMrB;AAAM,UAAA,SAAS,EAAC,MAAhB;AAAA,qBAAwB9B,IAAI,CAACK,MAAL,CAAY,OAAZ,CAAxB;AAAA;AAAA;AAAA;AAAA;AAAA;AANqB,SAEpBiB,CAFoB;AAAA;AAAA;AAAA;AAAA,eAAf,gBAQR;AAAa,QAAA,SAAS,EAAC,yBAAvB;AAAA,qCAAmD;AAAK,UAAA,SAAS,EAAC,YAAf;AAAA,iCAA4B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA5B;AAAA;AAAA;AAAA;AAAA,iBAAnD;AAAA,SAAUA,CAAV;AAAA;AAAA;AAAA;AAAA,eARN;AAUAJ,MAAAA,KAAK,CAACe,IAAN,CAAWD,OAAX;AACAV,MAAAA,CAAC;AACDtB,MAAAA,IAAI,GAAGA,IAAI,CAACQ,GAAL,CAASI,gBAAgB,CAACsB,KAA1B,EAAiC,SAAjC,CAAP;AAxC0B;;AAc7B,WAAOlC,IAAI,CAACmC,QAAL,CAAchB,OAAd,KAA0BG,CAAC,GAAEC,CAApC,EAAuC;AAAA;AA2BvC;;AAED,WAAOL,KAAP;AACH,GA5CD;;AA8CApC,EAAAA,SAAS,wEAAE;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBACY0D,KAAK,WAAIrD,MAAM,CAACsD,WAAX,+DAAwDnD,KAAK,CAACuB,OAA9D,oDAAwD,gBAAe6B,EAAvE,cAA6EnD,SAA7E,GAA0F;AAC9GoD,cAAAA,OAAO,EAAE;AACL,0BAAU,kBADL;AAEL,gCAAgB,kBAFX;AAGL,iDAA0B9C,QAAQ,CAAC+C,KAAnC;AAHK;AADqG,aAA1F,CADjB;;AAAA;AACDC,YAAAA,GADC;AAAA;AAAA,mBASYA,GAAG,CAACC,IAAJ,EATZ;;AAAA;AASDC,YAAAA,IATC;AAUPrD,YAAAA,kBAAkB,CAACqD,IAAI,CAACC,eAAN,CAAlB;;AAVO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAF,IAWN,CAACzD,SAAD,CAXM,CAAT;;AAcA,MAAM0D,cAAc,GAAG,SAAjBA,cAAiB,GAAM;AACzB,QAAI/B,KAAK,GAAG,EAAZ;;AACA,SAAK,IAAII,CAAC,GAAG,CAAb,EAAgBA,CAAC,IAAI,CAArB,EAAwBA,CAAC,EAAzB,EAA6B;AACzB,UAAIM,IAAI,GAAG7C,MAAM,CAACQ,SAAD,CAAN,CAAkBiB,GAAlB,CAAsBc,CAAtB,EAAyB,MAAzB,CAAX;;AACI,UAAI4B,eAAe,gBAAG;AAAa,QAAA,SAAS,EAAC,cAAvB;AAAA,gCAClB;AAAK,UAAA,SAAS,EAAC,oBAAf;AAAA,iCACI;AAAK,YAAA,SAAS,EAAC,cAAf;AAAA,oCACI;AAAK,cAAA,SAAS,EAAC,mBAAf;AAAA,yBAAoCtB,IAAI,CAACvB,MAAL,CAAY,MAAZ,CAApC;AAAA;AAAA;AAAA;AAAA;AAAA,qBADJ,eAEI;AAAK,cAAA,SAAS,EAAC,mBAAf;AAAA,wBAAoCuB,IAAI,CAACvB,MAAL,CAAY,GAAZ,IAAkB,GAAlB,GAAuBuB,IAAI,CAACvB,MAAL,CAAY,KAAZ;AAA3D;AAAA;AAAA;AAAA;AAAA,qBAFJ;AAAA;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,iBADkB,eAOlB;AAAA,qBACK+B,gBAAgB,CAACR,IAAD,CADrB,eAEI,QAAC,OAAD;AAAA;AAAA;AAAA;AAAA,mBAFJ,EAGKjB,eAAe,CAACiB,IAAD,CAHpB;AAAA;AAAA;AAAA;AAAA;AAAA,iBAPkB;AAAA,SAAUN,CAAV;AAAA;AAAA;AAAA;AAAA,eAAtB;;AAaJJ,MAAAA,KAAK,CAACe,IAAN,CAAWiB,eAAX;AAEH;;AACD,WAAOhC,KAAP;AACH,GArBD;;AAuBA,sBACI;AAAA,4BACI;AAAK,MAAA,SAAS,EAAC,qBAAf;AAAqC,MAAA,KAAK,EAAE5B,KAAK,CAAC6D,MAAN,KAAiB,IAAjB,GAAwB;AAAC5C,QAAAA,SAAS,EAAE,KAAZ;AAAmB6C,QAAAA,SAAS,EAAE;AAA9B,OAAxB,GAAgE;AAAC7C,QAAAA,SAAS,EAAE;AAAZ,OAA5G;AAAA,6BAEI;AAAK,QAAA,SAAS,EAAC,gBAAf;AAAA,gCACI;AAAK,UAAA,SAAS,EAAC,qBAAf;AAAA,iCACI;AAAQ,YAAA,SAAS,EAAC,EAAlB;AAAqB,YAAA,EAAE,EAAC,oBAAxB;AAA6C,YAAA,OAAO,EAAE;AAAA,qBAAMD,UAAU,CAAC,SAAD,CAAhB;AAAA,aAAtD;AAAA,6BAAwFhB,KAAK,CAAC6D,MAAN,KAAiB,IAAjB,gBAAwB,QAAC,cAAD;AAAgB,cAAA,KAAK,EAAC;AAAtB;AAAA;AAAA;AAAA;AAAA,oBAAxB,gBAA2D,QAAC,aAAD;AAAe,cAAA,KAAK,EAAC;AAArB;AAAA;AAAA;AAAA;AAAA,oBAAnJ;AAAA;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,gBADJ,eAII;AAAK,UAAA,SAAS,EAAC,UAAf;AAAA,oBACK7D,KAAK,CAACuB,OAAN,GAAeoC,cAAc,EAA7B,GAAkC;AADvC;AAAA;AAAA;AAAA;AAAA,gBAJJ,eAOI;AAAK,UAAA,SAAS,EAAC,qBAAf;AAAA,iCACI;AAAQ,YAAA,SAAS,EAAC,EAAlB;AAAqB,YAAA,EAAE,EAAC,iBAAxB;AAA0C,YAAA,OAAO,EAAE;AAAA,qBAAM3C,UAAU,CAAC,MAAD,CAAhB;AAAA,aAAnD;AAAA,6BAAkFhB,KAAK,CAAC6D,MAAN,KAAiB,IAAjB,gBAAwB,QAAC,aAAD;AAAgB,cAAA,KAAK,EAAC;AAAtB;AAAA;AAAA;AAAA;AAAA,oBAAxB,gBAA4D,QAAC,cAAD;AAAiB,cAAA,KAAK,EAAC;AAAvB;AAAA;AAAA;AAAA;AAAA,oBAA9I;AAAA;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,gBAPJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAFJ;AAAA;AAAA;AAAA;AAAA,YADJ,eAeI;AAAK,MAAA,SAAS,EAAC,mBAAf;AAAA,6BACA;AAAG,QAAA,IAAI,EAAC,EAAR;AAAW,QAAA,SAAS,EAAC,UAArB;AAAiC,QAAA,OAAO,EAAE;AAAA,iBAAMvD,UAAU,CAAC,IAAD,CAAhB;AAAA,SAA1C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AADA;AAAA;AAAA;AAAA;AAAA,YAfJ;AAAA;AAAA;AAAA;AAAA;AAAA,UADJ;AAwBH;;GA5LuBP,oB;UAKDD,O;;;KALCC,oB","sourcesContent":["\r\nimport {useState, useEffect} from 'react'\r\n\r\nimport moment from 'moment'\r\nimport { MdChevronLeft, MdChevronRight} from 'react-icons/md'\r\nimport { Divider } from '@material-ui/core';\r\n\r\nimport Config from './../../EndPoint'\r\nimport { useAuth } from './../../context/AuthContext';\r\n\r\nexport default function CalendarAvailability(props) {\r\n    const [startDate, setStartDate] = useState(moment())\r\n    const [calandar, setMedecinCalendar] = useState([])\r\n    const [showall, setShowall] = useState(false)\r\n\r\n    const {userData} = useAuth();\r\n\r\n    const selectHour = (day, hour, disable) => {\r\n        console.log(hour)\r\n        if(disable){\r\n        //    this.setState({ error: true, expired:true, message: 'ce moment est indisponible' })\r\n        //    setTimeout(() => {\r\n        //        this.setState({expired: false})\r\n        //    }, 5000);\r\n        }else{\r\n            props.setSelectedHour(day.format('YYYY/MM/DD'), hour)\r\n        }\r\n    }\r\n\r\n\r\n    const changeDate = (direction) => {\r\n       \r\n        if (direction === 'next'){\r\n            setStartDate( moment(startDate).add(7, 'days'))\r\n        }else{\r\n            if (moment(startDate).isAfter(moment())){\r\n                setStartDate( moment(startDate).subtract(7, 'days') )\r\n            //    this.setState({ startDate: moment(this.state.startDate).subtract(7, 'days') })\r\n           }\r\n        }\r\n    }\r\n\r\n    const createHoursSoir = (day) => {\r\n        const disponibiliteDay = props.medecin?.horaires.find(h => h.jour === day.format('dddd'));\r\n\r\n        if(!disponibiliteDay) return []\r\n\r\n        let table = [];\r\n        let endHour = moment(disponibiliteDay.fin_soir, 'HH:mm:ss');\r\n        let hour = moment(disponibiliteDay.debut_soir, 'HH:mm:ss');\r\n\r\n        let i=0;\r\n        let k=5;\r\n        if(showall){\r\n            k=100;\r\n        }\r\n         while (hour.isBefore(endHour) && i< k ){\r\n\r\n            \r\n            let element= undefined;\r\n\r\n            if(calandar){\r\n                // element = calandar.find( e => moment.utc(e.date).format('HH:mm') === hour)\r\n                element = calandar.find( e => {\r\n                    // return moment(e.date).isSame(day.format('YYYY-MM-DDT') + hour.format('HH:mm')+\":00.000Z\", \"minutes\")\r\n                    return e.time === hour.format('HH:mm:ss') && day.format('YYYY-MM-DD') === e.date\r\n                })\r\n            }\r\n            let HourInTheDay = moment( moment(day).format('YYYY/MM/DD') + hour.format('HH:mm'), 'YYYY/MM/DDHH:mm');\r\n            let isDisabled = (element !== undefined) || (moment().isAfter(HourInTheDay));\r\n\r\n            let cloneHour = hour.format('HH:mm')\r\n            let hourDiv = !isDisabled ?  <div \r\n                disabled={isDisabled} \r\n                key={i} \r\n                className={isDisabled ? \"cell hours-element disabled\" : \"cell hours-element\"} \r\n                onClick={ () => selectHour(day, cloneHour, isDisabled)}\r\n                >\r\n                    <span className=\"hour\"> {hour.format('HH:mm')} </span>\r\n                </div>\r\n                : <div key={i}  className=\" hours-element-disabled\" > <div className=\"hour-empty\"><span>-:-</span>   </div> </div>\r\n            table.push(hourDiv)\r\n            i++\r\n            hour = hour.add(disponibiliteDay.duree, 'minutes')\r\n        }\r\n\r\n        return table\r\n    }\r\n    \r\n\r\n\r\n    const createHoursMatin = (day) => {\r\n        const disponibiliteDay = props.medecin?.horaires.find(h => h.jour === day.lang(\"fr\").format('dddd'));\r\n\r\n        if(!disponibiliteDay) return []\r\n\r\n        let table = [];\r\n        let endHour = moment(disponibiliteDay.fin_matin, 'HH:mm:ss') ;\r\n        let hour = moment(disponibiliteDay.debut_matin, 'HH:mm:ss');\r\n\r\n        let i=0;\r\n        let k=5;\r\n        if(showall){\r\n            k=100;\r\n        }\r\n         while (hour.isBefore(endHour) && i< k ){\r\n            let element= undefined;\r\n\r\n            if(calandar){\r\n                element = calandar.find( e => {\r\n                    return e.time === hour.format('HH:mm:ss') && day.format('YYYY-MM-DD') === e.date\r\n                \r\n                })\r\n            }\r\n            \r\n            let HourInTheDay = moment( moment(day).format('YYYY/MM/DD') + hour, 'YYYY/MM/DDHH:mm');\r\n            let cloneHour = hour.format('HH:mm')\r\n\r\n            let isDisabled = (element !== undefined) || (moment().isAfter(HourInTheDay));\r\n            let hourDiv = !isDisabled ?  <div \r\n                disabled={isDisabled} \r\n                key={i} \r\n                className={isDisabled ? \"cell hours-element disabled\" : \"cell hours-element\"} \r\n                onClick={ () => selectHour(day, cloneHour, isDisabled)}\r\n                >\r\n                    <span className=\"hour\">{hour.format('HH:mm')}  </span>\r\n                </div>\r\n                : <div key={i} className=\" hours-element-disabled\" > <div className=\"hour-empty\"><span>-:-</span></div> </div>\r\n\r\n            table.push(hourDiv)\r\n            i++\r\n            hour = hour.add(disponibiliteDay.duree, 'minutes')\r\n        }\r\n\r\n        return table\r\n    }\r\n\r\n    useEffect( async () => {\r\n        const res =  await fetch(`${Config.BACKEND_URL}/consultation/medecin-calendar/${props.medecin?.id}/${startDate}`, {\r\n            headers: {\r\n                'Accept': 'application/json', \r\n                'Content-Type': 'application/json',\r\n                'Authorization': `token ${userData.token}`,\r\n\r\n            },\r\n        })\r\n        const data = await res.json();\r\n        setMedecinCalendar(data.medecinCalendar)\r\n    }, [startDate]);\r\n\r\n\r\n    const createCalendar = () => {\r\n        let table = [];\r\n        for (let i = 0; i <= 6; i++) {\r\n            let date = moment(startDate).add(i, 'days');\r\n                let dayAvailability = <div key={i} className=\"calendar-day\">\r\n                    <div className=\"calendar-day-title\">\r\n                        <div className=\"cell-content\">\r\n                            <div className=\"calendar-day-name\">{date.format('dddd')} </div>\r\n                            <div className=\"calendar-day-date\">{date.format('D')+ \" \" +date.format(\"MMM\")}</div>\r\n                        </div>\r\n                    </div> \r\n                    <div>\r\n                        {createHoursMatin(date)}\r\n                        <Divider />\r\n                        {createHoursSoir(date)}\r\n                    </div>\r\n            </div>\r\n            table.push(dayAvailability)\r\n            \r\n        }\r\n        return table\r\n    }\r\n\r\n    return(\r\n        <section>\r\n            <div className=\"date-range-calendar\" style={props.locale === \"ar\" ? {direction: \"rtl\", textAlign: \"right\"}: {direction: \"ltr\"}}>\r\n\r\n                <div className=\"range-calendar\">\r\n                    <div className=\"calendar-pagination\">\r\n                        <button className=\"\" id=\"date-range-preview\" onClick={() => changeDate('preview')}  >  {props.locale === \"ar\" ? <MdChevronRight color='#1AB9B9'/>: <MdChevronLeft color='#1AB9B9' />}  </button>\r\n                    </div>\r\n                    <div className=\"calendar\">\r\n                        {props.medecin? createCalendar() : null}\r\n                    </div>\r\n                    <div className=\"calendar-pagination\">\r\n                        <button className=\"\" id=\"date-range-next\" onClick={() => changeDate('next')}  >  {props.locale === \"ar\" ? <MdChevronLeft  color='#1AB9B9' />: <MdChevronRight  color='#1AB9B9' />} </button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div className='text-center w-100'>\r\n            <a href=\"\" className=\"show-all\"  onClick={() => setShowall(true)}  > \r\n            \r\n            VOIRE PLUS D’HORAIRES\r\n            </a>\r\n            </div>\r\n        </section>\r\n    )\r\n}\r\n"]},"metadata":{},"sourceType":"module"}