{"ast":null,"code":"import _regeneratorRuntime from \"C:/app/doctolive_code/patient-doctolive/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"C:/app/doctolive_code/patient-doctolive/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"C:\\\\app\\\\doctolive_code\\\\patient-doctolive\\\\components\\\\MedecinWidget\\\\CalendarAvailability.js\",\n    _s = $RefreshSig$();\n\nimport { useState, useEffect } from 'react';\nimport moment from 'moment';\nimport { MdChevronLeft, MdChevronRight } from 'react-icons/md';\nimport { Divider } from '@material-ui/core';\nimport Config from './../../EndPoint';\nimport { useAuth } from './../../context/AuthContext';\nexport default function CalendarAvailability(props) {\n  _s();\n\n  var _this = this;\n\n  var _useState = useState(moment()),\n      startDate = _useState[0],\n      setStartDate = _useState[1];\n\n  var _useState2 = useState([]),\n      calendar = _useState2[0],\n      setMedecinCalendar = _useState2[1];\n\n  var _useState3 = useState(false),\n      showAllMorning = _useState3[0],\n      setShowAllMorning = _useState3[1];\n\n  var _useState4 = useState(false),\n      showAllEvening = _useState4[0],\n      setShowAllEvening = _useState4[1];\n\n  var _useAuth = useAuth(),\n      userData = _useAuth.userData;\n\n  var selectHour = function selectHour(day, hour, disable) {\n    if (!disable) {\n      props.setSelectedHour(day.format('YYYY/MM/DD'), hour);\n    }\n  };\n\n  var changeDate = function changeDate(direction) {\n    if (direction === 'next') {\n      setStartDate(moment(startDate).add(7, 'days'));\n    } else {\n      if (moment(startDate).isAfter(moment())) {\n        setStartDate(moment(startDate).subtract(7, 'days'));\n      }\n    }\n  };\n\n  var createHours = function createHours(day, period) {\n    var _props$medecin;\n\n    var disponibiliteDay = (_props$medecin = props.medecin) === null || _props$medecin === void 0 ? void 0 : _props$medecin.horaires.find(function (h) {\n      return h.jour === day.format('dddd');\n    });\n    if (!disponibiliteDay) return [];\n    var table = [];\n    var endHour = moment(disponibiliteDay[\"fin_\".concat(period)], 'HH:mm:ss');\n    var hour = moment(disponibiliteDay[\"debut_\".concat(period)], 'HH:mm:ss');\n    var i = 0;\n\n    var _loop = function _loop() {\n      var element = undefined;\n\n      if (calendar) {\n        element = calendar.find(function (e) {\n          return e.time === hour.format('HH:mm:ss') && day.format('YYYY-MM-DD') === e.date;\n        });\n      }\n\n      var HourInTheDay = moment(moment(day).format('YYYY/MM/DD') + hour.format('HH:mm'), 'YYYY/MM/DDHH:mm');\n      var isDisabled = element !== undefined || moment().isAfter(HourInTheDay);\n      var cloneHour = hour.format('HH:mm');\n      var hourDiv = !isDisabled ? /*#__PURE__*/_jsxDEV(\"div\", {\n        disabled: isDisabled,\n        className: isDisabled ? \"cell hours-element disabled\" : \"cell hours-element\",\n        onClick: function onClick() {\n          return selectHour(day, cloneHour, isDisabled);\n        },\n        children: /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"hour\",\n          children: hour.format('HH:mm')\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 59,\n          columnNumber: 21\n        }, _this)\n      }, i, false, {\n        fileName: _jsxFileName,\n        lineNumber: 53,\n        columnNumber: 17\n      }, _this) : /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"hours-element-disabled\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"hour-empty\",\n          children: /*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"-:-\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 63,\n            columnNumber: 49\n          }, _this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 63,\n          columnNumber: 21\n        }, _this)\n      }, i, false, {\n        fileName: _jsxFileName,\n        lineNumber: 62,\n        columnNumber: 17\n      }, _this);\n      table.push(hourDiv);\n      i++;\n      hour = hour.add(disponibiliteDay.duree, 'minutes');\n    };\n\n    while (hour.isBefore(endHour) && i < 100) {\n      _loop();\n    }\n\n    return table;\n  };\n\n  var createHoursMatin = function createHoursMatin(day) {\n    var hours = createHours(day, 'matin');\n\n    if (!showAllMorning) {\n      hours = hours.slice(0, 5);\n    }\n\n    return hours;\n  };\n\n  var createHoursSoir = function createHoursSoir(day) {\n    var hours = createHours(day, 'soir');\n\n    if (!showAllEvening) {\n      hours = hours.slice(0, 5);\n    }\n\n    return hours;\n  };\n\n  useEffect(function () {\n    var fetchCalendar = /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        var _props$medecin2;\n\n        var res, data;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return fetch(\"\".concat(Config.BACKEND_URL, \"/consultation/medecin-calendar/\").concat((_props$medecin2 = props.medecin) === null || _props$medecin2 === void 0 ? void 0 : _props$medecin2.id, \"/\").concat(startDate), {\n                  headers: {\n                    'Accept': 'application/json',\n                    'Content-Type': 'application/json',\n                    'Authorization': \"token \".concat(userData.token)\n                  }\n                });\n\n              case 2:\n                res = _context.sent;\n                _context.next = 5;\n                return res.json();\n\n              case 5:\n                data = _context.sent;\n                setMedecinCalendar(data.medecinCalendar);\n\n              case 7:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      return function fetchCalendar() {\n        return _ref.apply(this, arguments);\n      };\n    }();\n\n    fetchCalendar();\n  }, [startDate]);\n\n  var createCalendar = function createCalendar() {\n    var table = [];\n\n    for (var i = 0; i <= 6; i++) {\n      var date = moment(startDate).add(i, 'days');\n\n      var dayAvailability = /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"calendar-day\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"calendar-day-title\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"cell-content\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"calendar-day-name\",\n              children: date.format('dddd')\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 113,\n              columnNumber: 29\n            }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"calendar-day-date\",\n              children: date.format('D') + \" \" + date.format(\"MMM\")\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 114,\n              columnNumber: 29\n            }, _this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 112,\n            columnNumber: 25\n          }, _this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 111,\n          columnNumber: 21\n        }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [createHoursMatin(date), /*#__PURE__*/_jsxDEV(Divider, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 119,\n            columnNumber: 25\n          }, _this), createHoursSoir(date)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 117,\n          columnNumber: 21\n        }, _this)]\n      }, i, true, {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 17\n      }, _this);\n\n      table.push(dayAvailability);\n    }\n\n    return table;\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"section\", {\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"date-range-calendar\",\n      style: props.locale === \"ar\" ? {\n        direction: \"rtl\",\n        textAlign: \"right\"\n      } : {\n        direction: \"ltr\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"range-calendar\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"calendar-pagination\",\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"\",\n            id: \"date-range-preview\",\n            onClick: function onClick() {\n              return changeDate('preview');\n            },\n            children: props.locale === \"ar\" ? /*#__PURE__*/_jsxDEV(MdChevronRight, {\n              color: \"#1AB9B9\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 135,\n              columnNumber: 54\n            }, this) : /*#__PURE__*/_jsxDEV(MdChevronLeft, {\n              color: \"#1AB9B9\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 135,\n              columnNumber: 91\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 134,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 133,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"calendar\",\n          children: props.medecin ? createCalendar() : null\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 138,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"calendar-pagination\",\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"\",\n            id: \"date-range-next\",\n            onClick: function onClick() {\n              return changeDate('next');\n            },\n            children: props.locale === \"ar\" ? /*#__PURE__*/_jsxDEV(MdChevronLeft, {\n              color: \"#1AB9B9\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 143,\n              columnNumber: 54\n            }, this) : /*#__PURE__*/_jsxDEV(MdChevronRight, {\n              color: \"#1AB9B9\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 143,\n              columnNumber: 90\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 142,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 141,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 132,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"show-all-buttons\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: function onClick() {\n            return setShowAllMorning(!showAllMorning);\n          },\n          children: showAllMorning ? \"Show Less Morning\" : \"Show All Morning\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 148,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: function onClick() {\n            return setShowAllEvening(!showAllEvening);\n          },\n          children: showAllEvening ? \"Show Less Evening\" : \"Show All Evening\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 151,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 147,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 130,\n    columnNumber: 9\n  }, this);\n}\n\n_s(CalendarAvailability, \"vfmk8Lb08r2zv2mdSIHU9V5WNv0=\", false, function () {\n  return [useAuth];\n});\n\n_c = CalendarAvailability;\n\nvar _c;\n\n$RefreshReg$(_c, \"CalendarAvailability\");","map":{"version":3,"sources":["C:/app/doctolive_code/patient-doctolive/components/MedecinWidget/CalendarAvailability.js"],"names":["useState","useEffect","moment","MdChevronLeft","MdChevronRight","Divider","Config","useAuth","CalendarAvailability","props","startDate","setStartDate","calendar","setMedecinCalendar","showAllMorning","setShowAllMorning","showAllEvening","setShowAllEvening","userData","selectHour","day","hour","disable","setSelectedHour","format","changeDate","direction","add","isAfter","subtract","createHours","period","disponibiliteDay","medecin","horaires","find","h","jour","table","endHour","i","element","undefined","e","time","date","HourInTheDay","isDisabled","cloneHour","hourDiv","push","duree","isBefore","createHoursMatin","hours","slice","createHoursSoir","fetchCalendar","fetch","BACKEND_URL","id","headers","token","res","json","data","medecinCalendar","createCalendar","dayAvailability","locale","textAlign"],"mappings":"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","sourcesContent":["import { useState, useEffect } from 'react';\r\nimport moment from 'moment';\r\nimport { MdChevronLeft, MdChevronRight } from 'react-icons/md';\r\nimport { Divider } from '@material-ui/core';\r\nimport Config from './../../EndPoint';\r\nimport { useAuth } from './../../context/AuthContext';\r\n\r\nexport default function CalendarAvailability(props) {\r\n    const [startDate, setStartDate] = useState(moment());\r\n    const [calendar, setMedecinCalendar] = useState([]);\r\n    const [showAllMorning, setShowAllMorning] = useState(false);\r\n    const [showAllEvening, setShowAllEvening] = useState(false);\r\n    const { userData } = useAuth();\r\n\r\n    const selectHour = (day, hour, disable) => {\r\n        if (!disable) {\r\n            props.setSelectedHour(day.format('YYYY/MM/DD'), hour);\r\n        }\r\n    };\r\n\r\n    const changeDate = (direction) => {\r\n        if (direction === 'next') {\r\n            setStartDate(moment(startDate).add(7, 'days'));\r\n        } else {\r\n            if (moment(startDate).isAfter(moment())) {\r\n                setStartDate(moment(startDate).subtract(7, 'days'));\r\n            }\r\n        }\r\n    };\r\n\r\n    const createHours = (day, period) => {\r\n        const disponibiliteDay = props.medecin?.horaires.find(h => h.jour === day.format('dddd'));\r\n\r\n        if (!disponibiliteDay) return [];\r\n\r\n        let table = [];\r\n        let endHour = moment(disponibiliteDay[`fin_${period}`], 'HH:mm:ss');\r\n        let hour = moment(disponibiliteDay[`debut_${period}`], 'HH:mm:ss');\r\n\r\n        let i = 0;\r\n\r\n        while (hour.isBefore(endHour) && i < 100) {\r\n            let element = undefined;\r\n\r\n            if (calendar) {\r\n                element = calendar.find(e => e.time === hour.format('HH:mm:ss') && day.format('YYYY-MM-DD') === e.date);\r\n            }\r\n            let HourInTheDay = moment(moment(day).format('YYYY/MM/DD') + hour.format('HH:mm'), 'YYYY/MM/DDHH:mm');\r\n            let isDisabled = (element !== undefined) || (moment().isAfter(HourInTheDay));\r\n\r\n            let cloneHour = hour.format('HH:mm');\r\n            let hourDiv = !isDisabled ? (\r\n                <div\r\n                    disabled={isDisabled}\r\n                    key={i}\r\n                    className={isDisabled ? \"cell hours-element disabled\" : \"cell hours-element\"}\r\n                    onClick={() => selectHour(day, cloneHour, isDisabled)}\r\n                >\r\n                    <span className=\"hour\">{hour.format('HH:mm')}</span>\r\n                </div>\r\n            ) : (\r\n                <div key={i} className=\"hours-element-disabled\">\r\n                    <div className=\"hour-empty\"><span>-:-</span></div>\r\n                </div>\r\n            );\r\n            table.push(hourDiv);\r\n            i++;\r\n            hour = hour.add(disponibiliteDay.duree, 'minutes');\r\n        }\r\n\r\n        return table;\r\n    };\r\n\r\n    const createHoursMatin = (day) => {\r\n        let hours = createHours(day, 'matin');\r\n        if (!showAllMorning) {\r\n            hours = hours.slice(0, 5);\r\n        }\r\n        return hours;\r\n    };\r\n\r\n    const createHoursSoir = (day) => {\r\n        let hours = createHours(day, 'soir');\r\n        if (!showAllEvening) {\r\n            hours = hours.slice(0, 5);\r\n        }\r\n        return hours;\r\n    };\r\n\r\n    useEffect(() => {\r\n        const fetchCalendar = async () => {\r\n            const res = await fetch(`${Config.BACKEND_URL}/consultation/medecin-calendar/${props.medecin?.id}/${startDate}`, {\r\n                headers: {\r\n                    'Accept': 'application/json',\r\n                    'Content-Type': 'application/json',\r\n                    'Authorization': `token ${userData.token}`,\r\n                },\r\n            });\r\n            const data = await res.json();\r\n            setMedecinCalendar(data.medecinCalendar);\r\n        };\r\n        fetchCalendar();\r\n    }, [startDate]);\r\n\r\n    const createCalendar = () => {\r\n        let table = [];\r\n        for (let i = 0; i <= 6; i++) {\r\n            let date = moment(startDate).add(i, 'days');\r\n            let dayAvailability = (\r\n                <div key={i} className=\"calendar-day\">\r\n                    <div className=\"calendar-day-title\">\r\n                        <div className=\"cell-content\">\r\n                            <div className=\"calendar-day-name\">{date.format('dddd')}</div>\r\n                            <div className=\"calendar-day-date\">{date.format('D') + \" \" + date.format(\"MMM\")}</div>\r\n                        </div>\r\n                    </div>\r\n                    <div>\r\n                        {createHoursMatin(date)}\r\n                        <Divider />\r\n                        {createHoursSoir(date)}\r\n                    </div>\r\n                </div>\r\n            );\r\n            table.push(dayAvailability);\r\n        }\r\n        return table;\r\n    };\r\n\r\n    return (\r\n        <section>\r\n            <div className=\"date-range-calendar\" style={props.locale === \"ar\" ? { direction: \"rtl\", textAlign: \"right\" } : { direction: \"ltr\" }}>\r\n                <div className=\"range-calendar\">\r\n                    <div className=\"calendar-pagination\">\r\n                        <button className=\"\" id=\"date-range-preview\" onClick={() => changeDate('preview')} >\r\n                            {props.locale === \"ar\" ? <MdChevronRight color='#1AB9B9' /> : <MdChevronLeft color='#1AB9B9' />}\r\n                        </button>\r\n                    </div>\r\n                    <div className=\"calendar\">\r\n                        {props.medecin ? createCalendar() : null}\r\n                    </div>\r\n                    <div className=\"calendar-pagination\">\r\n                        <button className=\"\" id=\"date-range-next\" onClick={() => changeDate('next')} >\r\n                            {props.locale === \"ar\" ? <MdChevronLeft color='#1AB9B9' /> : <MdChevronRight color='#1AB9B9' />}\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n                <div className=\"show-all-buttons\">\r\n                    <button onClick={() => setShowAllMorning(!showAllMorning)}>\r\n                        {showAllMorning ? \"Show Less Morning\" : \"Show All Morning\"}\r\n                    </button>\r\n                    <button onClick={() => setShowAllEvening(!showAllEvening)}>\r\n                        {showAllEvening ? \"Show Less Evening\" : \"Show All Evening\"}\r\n                    </button>\r\n                </div>\r\n            </div>\r\n        </section>\r\n    );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}