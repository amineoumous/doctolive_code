{"ast":null,"code":"import _classCallCheck from \"C:\\\\Users\\\\CARRE\\\\Documents\\\\GitHub\\\\doctolive_code\\\\pro-doctolive\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:\\\\Users\\\\CARRE\\\\Documents\\\\GitHub\\\\doctolive_code\\\\pro-doctolive\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _assertThisInitialized from \"C:\\\\Users\\\\CARRE\\\\Documents\\\\GitHub\\\\doctolive_code\\\\pro-doctolive\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"C:\\\\Users\\\\CARRE\\\\Documents\\\\GitHub\\\\doctolive_code\\\\pro-doctolive\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nimport _createSuper from \"C:\\\\Users\\\\CARRE\\\\Documents\\\\GitHub\\\\doctolive_code\\\\pro-doctolive\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";\nvar _jsxFileName = \"C:\\\\Users\\\\CARRE\\\\Documents\\\\GitHub\\\\doctolive_code\\\\pro-doctolive\\\\src\\\\views\\\\Chat\\\\VideoCall.js\";\nimport React, { Component } from 'react';\nimport Peer from 'simple-peer';\nimport autoBind from 'react-autobind';\nimport { Button, Row, Col } from 'react-bootstrap';\nimport { FaPhoneSlash } from 'react-icons/fa';\nimport Axios from 'axios';\nimport Config from 'Config';\n\nvar ElemenetsCall = /*#__PURE__*/function (_Component) {\n  _inherits(ElemenetsCall, _Component);\n\n  var _super = _createSuper(ElemenetsCall);\n\n  function ElemenetsCall(props) {\n    var _this;\n\n    _classCallCheck(this, ElemenetsCall);\n\n    _this = _super.call(this, props);\n    autoBind(_assertThisInitialized(_this));\n    _this.state = {\n      stream: null,\n      passingCall: false,\n      patientReady: false\n    };\n    _this.timerCall = null;\n    return _this;\n  }\n\n  _createClass(ElemenetsCall, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      this.setupSocket();\n      var constraints = {\n        video: {\n          facingMode: \"user\",\n          width: 640,\n          height: 480,\n          cursor: \"motion\"\n        },\n        audio: true\n      };\n      this.initiatorCallVideo(constraints).then(function (stream) {\n        window.streamReference = stream;\n\n        _this2.setState({\n          stream: stream\n        });\n\n        try {\n          _this2.myVideo.srcObject = stream;\n        } catch (e) {\n          _this2.myVideo.src = URL.createObjectURL(stream);\n        } // try {\n        //     this.callerTone.src = callerTone\n        // } catch (e) {\n        //     this.callerTone.srcObject =  URL.createObjectURL(callerTone) \n        // }\n\n\n        _this2.props.socket.emit('call-patient', {\n          selectedUser: 'p' + _this2.props.patient.id\n        }, function (response) {});\n      })[\"catch\"](function (err) {\n        console.log(\"Unable to fetsh stream \".concat(err));\n      });\n    }\n  }, {\n    key: \"setupSocket\",\n    value: function setupSocket() {\n      var _this3 = this;\n\n      var socket = this.props.socket;\n      socket.on('reject-call-medecin', function (response) {\n        _this3.stopStream();\n\n        _this3.setState({\n          stream: null,\n          responding: false\n        });\n\n        _this3.props.setonCalling(false);\n      });\n      socket.on('signal-call', function (_ref) {\n        var data = _ref.data;\n\n        var peer = _this3.setUpPeer();\n\n        _this3.setState({\n          peer: peer\n        });\n\n        console.log(data);\n        peer.signal(data);\n      });\n      socket.on('ready-patient', function (response) {\n        socket.emit('client-call', {\n          selectedUser: 'p' + _this3.props.patient.id\n        }, function () {});\n\n        _this3.setState({\n          patientReady: true\n        });\n\n        _this3.timerCall = setTimeout(function () {\n          if (!_this3.state.responding) {\n            _this3.rejectCall();\n          }\n        }, 15000); // this.callerTone.play();          \n      });\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      this.props.socket.removeAllListeners('reject-call-medecin');\n      this.props.socket.removeAllListeners('signal-call');\n      this.props.socket.removeAllListeners('ready-patient');\n\n      if (this.timerCall !== null) {\n        clearTimeout(this.timerCall);\n      }\n\n      if (this.state.peer) {\n        this.state.peer.destroy();\n      }\n    }\n  }, {\n    key: \"setUpPeer\",\n    value: function setUpPeer() {\n      var _this4 = this;\n\n      var peer = new Peer({\n        initiator: false,\n        stream: this.state.stream,\n        config: {\n          iceServers: [{\n            urls: \"stun:pelia.ma:3478\"\n          }, {\n            urls: \"turn:pelia.ma:3478\",\n            username: \"peliaturn\",\n            credential: \"ejfLUNE6C=fM&4P!\"\n          }]\n        },\n        trickle: false\n      });\n      peer.on('signal', function (data) {\n        _this4.props.socket.emit('medecin-confirm-call', {\n          selectedUser: 'p' + _this4.props.patient.id,\n          data: data\n        });\n      });\n      peer.on('stream', function (stream) {\n        try {\n          _this4.userVideo.srcObject = stream;\n        } catch (e) {\n          _this4.userVideo.src = URL.createObjectURL(stream);\n        }\n\n        _this4.userVideo.play(); // this.callerTone.pause();\n\n\n        _this4.setState({\n          passingCall: true,\n          responding: true,\n          timeAppel: Date.now()\n        }); // post call time start !\n\n\n        Axios.post(\"\".concat(Config.BACKEND_URL, \"/consultation/videocall/\").concat(_this4.props.teleconsultation.id), {}, {\n          headers: {\n            'Content-Type': 'application/json',\n            'Authorization': \"token \".concat(_this4.props.UserData.token)\n          }\n        }).then(function (result) {\n          console.log(result.data.videocall.id);\n\n          _this4.setState({\n            callId: result.data.videocall.id\n          });\n        })[\"catch\"](function (e) {\n          console.log(e.response);\n        });\n      });\n      peer.on('close', function () {\n        // post call time start !\n        Axios.put(\"\".concat(Config.BACKEND_URL, \"/consultation/videocall/\").concat(_this4.state.callId), {}, {\n          headers: {\n            'Content-Type': 'application/json',\n            'Authorization': \"token \".concat(_this4.props.UserData.token)\n          }\n        }).then(function (result) {})[\"catch\"](function (e) {\n          console.log(e.response);\n        });\n\n        _this4.stopStream();\n\n        _this4.setState({\n          passingCall: false,\n          stream: null,\n          responding: false\n        });\n\n        _this4.props.setonCalling(false);\n\n        if (_this4.state.peer) {\n          _this4.state.peer.destroy();\n        }\n      });\n      peer.on('error', function (err) {\n        console.log(\"vous avez perdue la connextion avec votre patient \".concat(err));\n      });\n      return peer;\n    }\n  }, {\n    key: \"initiatorCallVideo\",\n    value: function initiatorCallVideo(constraints) {\n      return new Promise(function (resolve, reject) {\n        navigator.mediaDevices.getUserMedia(constraints).then(function (stream) {\n          resolve(stream);\n        })[\"catch\"](function (err) {\n          reject(err);\n        });\n      });\n    }\n  }, {\n    key: \"stopStream\",\n    value: function stopStream() {\n      // if(this.callerTone !== null){\n      //     this.callerTone.muted = true;\n      //     this.callerTone= null;\n      // }\n      if (!window.streamReference) return;\n      window.streamReference.getAudioTracks().forEach(function (track) {\n        track.stop();\n      });\n      window.streamReference.getVideoTracks().forEach(function (track) {\n        track.stop();\n      });\n      window.streamReference = null;\n    }\n  }, {\n    key: \"rejectCall\",\n    value: function rejectCall() {\n      this.props.socket.emit('medecin-reject', {\n        selectedUser: 'p' + this.props.patient.id,\n        reject: true\n      }, function () {});\n      this.stopStream();\n      this.setState({\n        passingCall: false,\n        stream: null,\n        responding: false\n      });\n      this.props.setonCalling(false);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this5 = this;\n\n      var _this$state = this.state,\n          responding = _this$state.responding,\n          passingCall = _this$state.passingCall;\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"video medecin\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 214,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"audio\", {\n        ref: function ref(_ref2) {\n          return _this5.callerTone = _ref2;\n        },\n        playsInline: true,\n        loop: true,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 216,\n          columnNumber: 17\n        }\n      }), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 217,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(Row, {\n        className: responding ? \"repondre video-container m-0 justify-content-center\" : \"video-container m-0 justify-content-center\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 218,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"video\", {\n        id: \"peerVid\",\n        ref: function ref(_ref3) {\n          _this5.userVideo = _ref3;\n        },\n        playsInline: true,\n        autoPlay: true,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 219,\n          columnNumber: 21\n        }\n      }), /*#__PURE__*/React.createElement(\"video\", {\n        id: \"myVid\",\n        muted: true,\n        ref: function ref(_ref4) {\n          _this5.myVideo = _ref4;\n        },\n        playsInline: true,\n        autoPlay: true,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 220,\n          columnNumber: 21\n        }\n      })), /*#__PURE__*/React.createElement(Row, {\n        className: !passingCall ? \"responding process\" : \"responding\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 223,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(Col, {\n        style: {\n          paddingLeft: 0\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 224,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"layer\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 225,\n          columnNumber: 21\n        }\n      }), !passingCall && /*#__PURE__*/React.createElement(Row, {\n        className: \"text-center d-flex justify-content-around w-100 p-4 ml-1 mt-5\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 227,\n          columnNumber: 25\n        }\n      }, /*#__PURE__*/React.createElement(\"p\", {\n        className: \"text-center caller \",\n        style: {\n          maxHeight: \"20%\"\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 228,\n          columnNumber: 29\n        }\n      }, \" \", this.state.patientReady ? \"appel en cours ...\" : \"en attente de connexion avec votre patient\", \" \")), /*#__PURE__*/React.createElement(Row, {\n        className: \"end-call\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 231,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(Button, {\n        onClick: function onClick() {\n          return _this5.rejectCall();\n        },\n        className: \"action\",\n        type: \"button\",\n        variant: \"danger\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 232,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(FaPhoneSlash, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 238,\n          columnNumber: 29\n        }\n      })))))));\n    }\n  }]);\n\n  return ElemenetsCall;\n}(Component);\n\nexport { ElemenetsCall as default };","map":{"version":3,"names":["React","Component","Peer","autoBind","Button","Row","Col","FaPhoneSlash","Axios","Config","ElemenetsCall","props","state","stream","passingCall","patientReady","timerCall","setupSocket","constraints","video","facingMode","width","height","cursor","audio","initiatorCallVideo","then","window","streamReference","setState","myVideo","srcObject","e","src","URL","createObjectURL","socket","emit","selectedUser","patient","id","response","err","console","log","on","stopStream","responding","setonCalling","data","peer","setUpPeer","signal","setTimeout","rejectCall","removeAllListeners","clearTimeout","destroy","initiator","config","iceServers","urls","username","credential","trickle","userVideo","play","timeAppel","Date","now","post","BACKEND_URL","teleconsultation","headers","UserData","token","result","videocall","callId","put","Promise","resolve","reject","navigator","mediaDevices","getUserMedia","getAudioTracks","forEach","track","stop","getVideoTracks","ref","callerTone","paddingLeft","maxHeight"],"sources":["C:/Users/CARRE/Documents/GitHub/doctolive_code/pro-doctolive/src/views/Chat/VideoCall.js"],"sourcesContent":["import React, { Component } from 'react';\r\nimport Peer from 'simple-peer';\r\nimport autoBind from 'react-autobind';\r\n\r\nimport { Button, Row, Col} from 'react-bootstrap'\r\nimport {FaPhoneSlash} from 'react-icons/fa'\r\n\r\nimport Axios from 'axios'\r\nimport Config from 'Config';\r\n\r\n\r\n\r\nexport default class ElemenetsCall extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n        autoBind(this);\r\n        this.state = {\r\n            stream: null,\r\n            passingCall:false,\r\n            patientReady:false\r\n        };\r\n        this.timerCall = null;\r\n    }\r\n    \r\n    componentDidMount() {\r\n        this.setupSocket();\r\n        const constraints={\r\n            video: {\r\n                facingMode: \"user\", \r\n                width: 640, \r\n                height: 480, \r\n                cursor:\"motion\"\r\n            }, \r\n            audio:true\r\n         }\r\n       \r\n        this.initiatorCallVideo(constraints)\r\n        .then((stream)=> {\r\n            window.streamReference = stream;\r\n            this.setState({ stream : stream});\r\n            try {\r\n                this.myVideo.srcObject = stream;\r\n            } catch (e) {\r\n                this.myVideo.src = URL.createObjectURL(stream)\r\n            }\r\n            // try {\r\n            //     this.callerTone.src = callerTone\r\n            // } catch (e) {\r\n            //     this.callerTone.srcObject =  URL.createObjectURL(callerTone) \r\n            // }\r\n            this.props.socket.emit('call-patient', { selectedUser: 'p' + this.props.patient.id}, (response) => {});\r\n        })\r\n        .catch((err)=>{\r\n            console.log(`Unable to fetsh stream ${err}`)\r\n        })\r\n       \r\n    }\r\n\r\n    setupSocket(){\r\n        let socket = this.props.socket;\r\n        socket.on('reject-call-medecin', (response) => {\r\n            this.stopStream();\r\n            this.setState({ stream : null, responding:false});  \r\n            this.props.setonCalling(false)\r\n        });\r\n\r\n        socket.on('signal-call', ({data}) => {\r\n            let peer = this.setUpPeer();\r\n            this.setState({peer})\r\n            console.log(data)\r\n            peer.signal(data);\r\n        });\r\n        \r\n        socket.on('ready-patient', (response) => {\r\n            socket.emit('client-call', {selectedUser: 'p' + this.props.patient.id}, () => {  });\r\n            this.setState({patientReady: true});\r\n            this.timerCall = setTimeout(() => {\r\n                if(!this.state.responding){\r\n                    (this.rejectCall())\r\n                }\r\n            }, 15000);\r\n            // this.callerTone.play();          \r\n        });\r\n    }\r\n    componentWillUnmount(){\r\n        this.props.socket.removeAllListeners('reject-call-medecin')\r\n        this.props.socket.removeAllListeners('signal-call')\r\n        this.props.socket.removeAllListeners('ready-patient')\r\n        if(this.timerCall !== null){\r\n            clearTimeout(this.timerCall)\r\n        }\r\n        if(this.state.peer){\r\n            this.state.peer.destroy();\r\n        }\r\n    }\r\n\r\n    setUpPeer(){\r\n        const peer = new Peer({\r\n            initiator: false,\r\n            stream: this.state.stream,\r\n            config: { iceServers: \r\n                [\r\n                    {\r\n                      urls: \"stun:pelia.ma:3478\",\r\n                    },\r\n                    {\r\n                      urls: \"turn:pelia.ma:3478\",\r\n                      username: \"peliaturn\",\r\n                      credential: \"ejfLUNE6C=fM&4P!\"\r\n                    }\r\n                ]\r\n            },\r\n            trickle: false\r\n        });\r\n\r\n        peer.on('signal', (data) => {\r\n            this.props.socket.emit('medecin-confirm-call', {selectedUser: 'p' + this.props.patient.id, data})\r\n        })\r\n        \r\n        peer.on('stream', (stream) => {\r\n            try {\r\n                this.userVideo.srcObject = stream;\r\n            } catch (e) {\r\n                this.userVideo.src = URL.createObjectURL(stream)\r\n            }\r\n            this.userVideo.play();\r\n            // this.callerTone.pause();\r\n            this.setState({passingCall: true, responding: true, timeAppel: Date.now() })\r\n\r\n                // post call time start !\r\n                Axios.post(`${Config.BACKEND_URL}/consultation/videocall/${this.props.teleconsultation.id}`,{} , { \r\n                    headers: {\r\n                        'Content-Type': 'application/json',\r\n                        'Authorization': `token ${this.props.UserData.token}`,\r\n                    }\r\n                })\r\n                .then(result => {\r\n                    console.log(result.data.videocall.id);\r\n                    this.setState({callId: result.data.videocall.id})\r\n                }).catch(e => {\r\n                    console.log(e.response)\r\n                });\r\n        });\r\n\r\n        peer.on('close', () =>{\r\n            // post call time start !\r\n            Axios.put(`${Config.BACKEND_URL}/consultation/videocall/${this.state.callId}`,{} , { \r\n                headers: {\r\n                    'Content-Type': 'application/json',\r\n                    'Authorization': `token ${this.props.UserData.token}`,\r\n                }\r\n            })\r\n            .then(result => {\r\n               \r\n            }).catch(e => {\r\n                console.log(e.response)\r\n            });\r\n\r\n            this.stopStream();\r\n            this.setState({passingCall: false, stream : null, responding:false});  \r\n            this.props.setonCalling(false)\r\n            if(this.state.peer){\r\n                this.state.peer.destroy()\r\n            }\r\n        });\r\n\r\n        peer.on('error', (err) => {\r\n            console.log( `vous avez perdue la connextion avec votre patient ${err}`)\r\n        });\r\n        return peer;\r\n    }\r\n\r\n     initiatorCallVideo(constraints){\r\n         \r\n        return new Promise((resolve, reject) => {\r\n            navigator.mediaDevices.getUserMedia(constraints)\r\n            .then((stream) => {\r\n                resolve(stream)\r\n            })\r\n            .catch(err => {\r\n                reject(err)\r\n            })\r\n        }); \r\n    }\r\n\r\n    stopStream() {\r\n        // if(this.callerTone !== null){\r\n        //     this.callerTone.muted = true;\r\n        //     this.callerTone= null;\r\n        // }\r\n        if (!window.streamReference) return;\r\n        window.streamReference.getAudioTracks().forEach(function(track) {\r\n            track.stop();\r\n        });\r\n        window.streamReference.getVideoTracks().forEach(function(track) {\r\n            track.stop();\r\n        });\r\n        window.streamReference = null;\r\n    }\r\n\r\n    rejectCall(){\r\n        this.props.socket.emit('medecin-reject', {selectedUser: 'p' + this.props.patient.id , reject: true }, () => {\r\n            \r\n        })\r\n        this.stopStream();\r\n        this.setState({ passingCall: false, stream : null, responding:false});  \r\n        this.props.setonCalling(false)\r\n        \r\n    }\r\n      \r\n    render() {\r\n        let { responding, passingCall} = this.state;\r\n        return (\r\n            <div className=\"video medecin\">\r\n                \r\n                <audio ref={ref => this.callerTone = ref} playsInline loop />\r\n                <div className=\"\">\r\n                <Row className={responding ? \"repondre video-container m-0 justify-content-center\" : \"video-container m-0 justify-content-center\"}>\r\n                    <video id=\"peerVid\" ref={(ref) => {this.userVideo = ref;}} playsInline autoPlay />\r\n                    <video id=\"myVid\" muted={true} ref={(ref) => {this.myVideo = ref;}}  playsInline autoPlay />\r\n                </Row>\r\n                   \r\n                <Row className={!passingCall ? \"responding process\": \"responding\"}>   \r\n                    <Col style={{paddingLeft:0}}>\r\n                    <div className=\"layer\"></div>\r\n                    { !passingCall &&                      \r\n                        <Row className=\"text-center d-flex justify-content-around w-100 p-4 ml-1 mt-5\">   \r\n                            <p className=\"text-center caller \" style={{maxHeight: \"20%\"}}> {this.state.patientReady ? \"appel en cours ...\": \"en attente de connexion avec votre patient\"} </p>\r\n                        </Row>    \r\n                    }\r\n                    <Row className=\"end-call\">\r\n                    <Button\r\n                        onClick={() => this.rejectCall()}\r\n                        className=\"action\" \r\n                        type=\"button\"\r\n                        variant= \"danger\"\r\n                        >\r\n                            <FaPhoneSlash /> \r\n                        </Button>\r\n                    </Row>\r\n                    </Col>\r\n                </Row>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}